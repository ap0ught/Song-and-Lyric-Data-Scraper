{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Lyric Data rev. 4\"\nauthor: \"Jacob Long\"\ndate: \"November 11, 2015\"\noutput:\n  pdf_document:\n    toc: true\n    highlight: zenburn\n---\n\n# First steps and data cleaning\n\nThe following is here for the sake of completeness/transparency/replicability, you by no means need to read through it to understand the analysis. You can skip to the analysis by [clicking here](#analysis).\n\nFirst, let's read in the data.\n```{r} \n#blues <- read.delim(\"~/BBSongDB/lyrics2/blues/blues100results.dat\");\n#christian <- read.delim(\"~/BBSongDB/lyrics2/christian/christian100results.dat\");\n#country <- read.delim(\"~/BBSongDB/lyrics2/country/country100results.dat\");\n#dance <- read.delim(\"~/BBSongDB/lyrics2/danceelectronic/danceelectronic100results.dat\");\n#jazz <- read.delim(\"~/BBSongDB/lyrics2/jazz/jazz100results.dat\");\n#pop <- read.delim(\"~/BBSongDB/lyrics2/pop/pop100results.dat\");\n#rbhiphop <- read.delim(\"~/BBSongDB/lyrics2/R&Bhip hop/rbhiphop100results.dat\");\n#rap <- read.delim(\"~/BBSongDB/lyrics2/rap/rap100results.dat\");\n#reggae <- read.delim(\"~/BBSongDB/lyrics2/reggae/reggae100results.dat\");\n#rock <- read.delim(\"~/BBSongDB/lyrics2/rock/rock100results.dat\");\n#surveydata <- read.csv(\"~/BBSongDB/R analysis/TOSU0011_OUTPUT.csv\");\n```\n\n\nAfter this I want to combine them into one data frame, so I am adding a variable to each one for \"genre\"\n```{r}\nblues$genre <- \"blues\"; christian$genre <- \"christian\"; country$genre <- \"country\"; dance$genre <- \"dance\"; jazz$genre <- \"jazz\"; pop$genre <- \"pop\"; rbhiphop$genre <- \"rbhiphop\"; rap$genre <- \"rap\"; reggae$genre <- \"reggae\"; rock$genre <- \"rock\";\n```\n\n\nNow I combine all the observations from each genre's data frame into a single data frame called \"combined\"\n```{r}\ncombined <- rbind(blues,christian,country,dance,jazz,pop,rbhiphop,rap,reggae,rock);\n```\n\nHere I collapse the \"vice\" and \"virtue\" categories into a \"total\" one for each foundation\n```{r}\ncombined$HarmTotal <- combined$HarmVirtue + combined$HarmVice;\ncombined$FairTotal <- combined$FairnessVirtue + combined$FairnessVice;\ncombined$IngTotal <- combined$IngroupVirtue + combined$IngroupVice;\ncombined$AuthTotal <- combined$AuthorityVirtue + combined$AuthorityVice;\ncombined$PurityTotal <- combined$PurityVirtue + combined$PurityVice;\n```\n\nIn MFT research, it has been said that a rough measure of \"progressivism\" might be subtracting Ingroup/Authority/Purity from Care/Fairness\n```{r}\ncombined$ProgressivismTotal <- ((combined$HarmTotal + combined$FairTotal)/2) - ((combined$IngTotal + combined$AuthTotal + combined$PurityTotal)/3);\ncombined$ProgVice <- (combined$HarmVice + combined$FairnessVice) - (combined$IngroupVice + combined$AuthorityVice + combined$PurityVice);\ncombined$ProgVirtue <- (combined$HarmVirtue + combined$FairnessVirtue) - (combined$IngroupVirtue + combined$AuthorityVirtue + combined$PurityVirtue);\ncombined$TotalMFT <- combined$HarmTotal + combined$AuthTotal + combined$IngTotal + combined$PurityTotal + combined$FairTotal;\ncombined$TotalMoral <- combined$TotalMFT + combined$MoralityGeneral;\n```\n\nNow that I've added these variables to the combined dataset, I'm going to subset each genre again with the new variables for future comparisons. If I don't do this, performing t-tests and the like won't be feasible (without confusing the analysis into thinking df = 1).\n```{r}\nblues <- subset(combined, genre=='blues');\nchristian <- subset(combined, genre=='christian');\ncountry <- subset(combined, genre=='country');\ndance <- subset(combined, genre=='dance');\njazz <- subset(combined, genre=='jazz');\npop <- subset(combined, genre=='pop');\nrap <- subset(combined, genre=='rap');\nrbhiphop <- subset(combined, genre=='rbhiphop');\nreggae <- subset(combined, genre=='reggae');\nrock <- subset(combined, genre=='rock');\n```\n\nNow I'm going to look at the means across each genre as a table. First, I'm going to create a variable that is just a list of the variables in \"combined\" that I don't want to compute means for\n```{r}\nirrelvars <- names(combined) %in% c(\"Filename\", \"Segment\", \"WC\");\n```\nHere I store this truncated table (minus Filename, Segment, and WC) as combined\n```{r}\ncombined <- combined[!irrelvars];\n```\nThis creates the table of genre means (as a data frame)\n```{r, warning=FALSE, error=FALSE, results='hide', message=FALSE}\n# It will throw some warnings about its inability to create an average of \"genre\"\ngenremeans <- aggregate(combined, by=list(genre = combined$genre), FUN = \"mean\");\n```\n\n\nThis calculates the total for each foundation as a portion of all MFT words and then all moral words. The distinction here that isn't 100% clear is whether to include the non-foundation-specific moral words. For now, I've calculated with both. Variables with \"2\" at the end are proportions of words out of *all* moral words, where as the ones without a 2 are out of only the *MFT* words. I'm also creating variables that has z-scores for these two variables; it will make graphing data easier.\n```{r}\ngenremeans$HarmTotPer = (genremeans$HarmTotal/genremeans$TotalMFT);\ngenremeans$AuthTotPer = (genremeans$AuthTotal/genremeans$TotalMFT);\ngenremeans$IngTotPer = (genremeans$IngTotal/genremeans$TotalMFT);\ngenremeans$FairTotPer = (genremeans$FairTotal/genremeans$TotalMFT);\ngenremeans$PurityTotPer = (genremeans$PurityTotal/genremeans$TotalMFT);\ngenremeans$ProgTotPer = (((genremeans$HarmTotal + genremeans$FairTotal)-(genremeans$IngTotPer+genremeans$FairTotPer+genremeans$PurityTotPer))/genremeans$TotalMFT);\n\ngenremeans$HarmTotPer2 = (genremeans$HarmTotal/genremeans$TotalMoral);\ngenremeans$AuthTotPer2 = (genremeans$AuthTotal/genremeans$TotalMoral);\ngenremeans$IngTotPer2 = (genremeans$IngTotal/genremeans$TotalMoral);\ngenremeans$FairTotPer2 = (genremeans$FairTotal/genremeans$TotalMoral);\ngenremeans$PurityTotPer2 = (genremeans$PurityTotal/genremeans$TotalMoral);\ngenremeans$MoralGenPer2 <- 1-(genremeans$HarmTotPer2 + genremeans$FairTotPer2+genremeans$AuthTotPer2+genremeans$IngTotPer2+genremeans$PurityTotPer2);\n```\n\n*11/9 change: Z-scores recoded for raw counts rather than proportions (storing in variable [foundation]Z2*\n```{r}\n# Creating a z-score variable for each of these as well\ngenremeans$HarmZ <- scale(genremeans$HarmTotPer);\ngenremeans$FairZ <- scale(genremeans$FairTotPer);\ngenremeans$AuthZ <- scale(genremeans$AuthTotPer);\ngenremeans$IngZ <- scale(genremeans$IngTotPer);\ngenremeans$PurityZ <- scale(genremeans$PurityTotPer);\n\ngenremeans$HarmZ2 <- scale(genremeans$HarmTotal);\ngenremeans$FairZ2 <- scale(genremeans$FairTotal);\ngenremeans$AuthZ2 <- scale(genremeans$AuthTotal);\ngenremeans$IngZ2 <- scale(genremeans$IngTotal);\ngenremeans$PurityZ2 <- scale(genremeans$PurityTotal);\n\ngenremeans$MoralGenZ2 <- scale(genremeans$MoralityGeneral);\n```\n\nThis calculates each foundation's virtue words as a portion of all MFT words\n```{r}\ngenremeans$HarmVirtPer = (genremeans$HarmVirtue/genremeans$TotalMFT);\ngenremeans$AuthVirtPer = (genremeans$AuthorityVirtue/genremeans$TotalMFT);\ngenremeans$IngVirtPer = (genremeans$IngroupVirtue/genremeans$TotalMFT);\ngenremeans$FairVirtPer = (genremeans$FairnessVirtue/genremeans$TotalMFT);\ngenremeans$PurityVirtPer = (genremeans$PurityVirtue/genremeans$TotalMFT);\n\ngenremeans$HarmVirtPer2 = (genremeans$HarmVirtue/genremeans$TotalMoral);\ngenremeans$AuthVirtPer2 = (genremeans$AuthorityVirtue/genremeans$TotalMoral);\ngenremeans$IngVirtPer2 = (genremeans$IngroupVirtue/genremeans$TotalMoral);\ngenremeans$FairVirtPer2 = (genremeans$FairnessVirtue/genremeans$TotalMoral);\ngenremeans$PurityVirtPer2 = (genremeans$PurityVirtue/genremeans$TotalMoral);\n```\n\nThis calculates each foundation's vice words as a portion of all MFT words\n```{r}\ngenremeans$HarmVicePer = (genremeans$HarmVice/genremeans$TotalMFT);\ngenremeans$AuthVicePer = (genremeans$AuthorityVice/genremeans$TotalMFT);\ngenremeans$IngVicePer = (genremeans$IngroupVice/genremeans$TotalMFT);\ngenremeans$FairVicePer = (genremeans$FairnessVice/genremeans$TotalMFT);\ngenremeans$PurityVicePer = (genremeans$PurityVice/genremeans$TotalMFT);\n\ngenremeans$HarmVicePer2 = (genremeans$HarmVice/genremeans$TotalMoral);\ngenremeans$AuthVicePer2 = (genremeans$AuthorityVice/genremeans$TotalMoral);\ngenremeans$IngVicePer2 = (genremeans$IngroupVice/genremeans$TotalMoral);\ngenremeans$FairVicePer2 = (genremeans$FairnessVice/genremeans$TotalMoral);\ngenremeans$PurityVicePer2 = (genremeans$PurityVice/genremeans$TotalMoral);\n```\n\nThis calculates each foundation's ratio of virtue to vice words. Larger numbers may indicate more endorsement of the foundation.\n```{r}\ngenremeans$HarmRatio = (genremeans$HarmVirtue/genremeans$HarmVice);\ngenremeans$FairRatio = (genremeans$FairnessVirtue/genremeans$FairnessVice);\ngenremeans$IngRatio = (genremeans$IngroupVirtue/genremeans$IngroupVice);\ngenremeans$AuthRatio = (genremeans$AuthorityVirtue/genremeans$AuthorityVice);\ngenremeans$PurityRatio = (genremeans$PurityVirtue/genremeans$PurityVice);\n```\n\nNow for ease of viewing data, I'm only going to include variables that I will analyze in this truncated table. There are a few other mostly technical operations going on here too that I won't bother elaborating on.\n```{r warning=FALSE}\nrelvars <- names(genremeans) %in% c(\"HarmTotPer\", \"FairTotPer\", \"AuthTotPer\", \"IngTotPer\", \"PurityTotPer\", \"ProgTotPer\",\n                                    \"HarmVirtPer\", \"FairVirtPer\", \"AuthVirtPer\", \"IngVirtPer\", \"PurityVirtPer\", \"HarmVicePer\", \"FairVicePer\",\n                                    \"AuthVicePer\", \"IngVicePer\", \"PurityVicePer\", \"HarmTotPer2\", \"FairTotPer2\", \"AuthTotPer2\", \"IngTotPer2\", \"PurityTotPer2\",\n                                    \"HarmVirtPer2\", \"FairVirtPer2\", \"AuthVirtPer2\", \"IngVirtPer2\", \"PurityVirtPer2\", \"HarmVicePer2\", \"FairVicePer2\",\n                                    \"AuthVicePer2\", \"IngVicePer2\", \"PurityVicePer2\", \"MoralGenPer2\", \"HarmRatio\", \"FairRatio\", \"AuthRatio\", \"IngRatio\", \"PurityRatio\", \"genre\");\n# Making a truncated version of the data frame\ntruncated <- genremeans[relvars];\n\n# Reshaping the data this way makes data visualization easier\nlibrary(reshape2);\ntruncated2 <- melt(genremeans);\n# This fixes a technical problem with R understanding what type of data we're working with \ntruncated2$value <- as.numeric(as.character(truncated2$value));\n# These create subsets to make it easier to graph results\ntrunctotalMoral <- subset(truncated2, variable %in% c(\"HarmTotPer2\",\"FairTotPer2\",\"AuthTotPer2\",\"IngTotPer2\",\"PurityTotPer2\", \"MoralGenPer2\"));\ntrunctotalMFT <- subset(truncated2, variable %in% c(\"HarmTotPer\",\"FairTotPer\",\"AuthTotPer\",\"IngTotPer\",\"PurityTotPer\"));\ntrunctotalMoralZ <- subset(truncated2, variable %in% c(\"HarmZ2\", \"FairZ2\", \"AuthZ2\", \"IngZ2\", \"PurityZ2\", \"MoralGenZ2\"));\ntrunctotalMFTZ <- subset(truncated2, variable %in% c(\"HarmZ\", \"FairZ\", \"AuthZ\", \"IngZ\", \"PurityZ\"));\n```\n\n\n# <a name-\"analysis\">Analysis</a>\n\nNow let's take a quick look at the data. I am loading a couple of packages and performing some operations just for the sake of display and won't describe them in detail. More meaningful is the output to come, where you will see the average rates of occurrence for each genre with the genres ordered from greatest to least in each foundation's case.\n```{r results='hide', error=FALSE, message=FALSE}\nlibrary(dplyr);\nlibrary(tidyr);\ncombined.grouped = group_by(combined, genre);\n```\n\n## Visualization\n\nHere's a grid of bar plots for each genre. Each bar represents (as a proportion of all MFT words) the amount of each foundation's words in that genre.\n```{r warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nMFTfreqchart <- ggplot(trunctotalMFT, aes(x=variable, y=value, fill=variable));\nMFTfreqchart <- MFTfreqchart + geom_bar(stat=\"identity\") + facet_wrap(~genre) + theme(axis.text.x = element_blank()) + ylab(\"Portion of total MFT words\");\nprint(MFTfreqchart);\n```\n\nHere's a grid of bar plots for each foundation, each bar represents a different genre. The Y-axis is the same as the set of plots before this (Y=X foundation's proportion of all MFT words from that genre)\n```{r warning=FALSE}\nMFTfreqchart2 <- ggplot(trunctotalMFT, aes(x=genre, y=value, fill=genre));\nMFTfreqchart2 <- MFTfreqchart2 + geom_bar(stat=\"identity\") + facet_wrap(~variable) + theme(axis.text.x = element_blank()) + ylab(\"Portion of total MFT words\");\nprint(MFTfreqchart2);\n```\n\nI don't think any of the two above plots are especially easy to interpret. Below, I'm going to use standardized scores for graphing to bring the differences across genres and foundations into better focus. The first two are equivalent to the two above, but the y-axis is **z-score** of the y-axis value on the above charts. \n```{r warning=FALSE}\nMFTfreqchartZ <- ggplot(trunctotalMFTZ, aes(x=variable, y=value, fill=variable));\nMFTfreqchartZ <- MFTfreqchartZ + geom_bar(stat=\"identity\") + facet_wrap(~genre) + theme(axis.text.x = element_blank()) + ylab(\"z-score\");\nprint(MFTfreqchartZ);\n```\n\nNow we can actually see some differentiation between genres. For instance, we can see that Christian and to a lesser extent country really stand apart from the others on the Purity/degradation foundation.\n\nJazz, perhaps surprisingly, is far above the rest in Ingroup/betrayal. \n\nRock appears least differentiated, in general, with no foundation's z-scores near even 1. \n\nPop is high in Care/harm and Fairness/cheating, which are almost universally held as very important in the USA, while it is low or near mean in the other three, which tend to alienate liberals. This makes perfect sense! The genre with broadest appeal should look that way. \n\n```{r warning=FALSE}\nMFTfreqchartZ2 <- ggplot(trunctotalMFTZ, aes(x=genre, y=value, fill=genre));\nMFTfreqchartZ2 <- MFTfreqchartZ2 + geom_bar(stat=\"identity\") + facet_wrap(~variable) + theme(axis.text.x = element_blank()) + ylab(\"z-score\");\nprint(MFTfreqchartZ2);\n```\n\nLooking at the z-scores by foundation makes these observations clearer in some cases.\n\nWhile I don't plan to do analysis this way, it is worth knowing the rates of moral foundation words *out of all words* rather than just moral ones. \n\n```{r warning=FALSE}\ntrunctotalwords <- genremeans[c(\"genre\",\"TotalMoral\")];\ntrunctotalwords <- melt(trunctotalwords);\ntotalmoralfreqchart <- ggplot(trunctotalwords, aes(x=genre, y=value, fill=genre));\ntotalmoralfreqchart <- totalmoralfreqchart + geom_bar(stat=\"identity\") + geom_text(aes(label= sprintf(\"%.02f%%\", value), y = value, vjust = -0.25, size=10), show_guide = FALSE) + ylab(\"Portion of all words\");\nprint(totalmoralfreqchart);\n```\n\nTo be clear about what you're seeing above, the y values are the *percentage of dictionary words—anything deemed moral—out of all words in the lyrics for that genre*. While the differences aren't meaningless, I think they don't call into question my decision to make comparisons on the basis of *per moral words* and *per foundation words* rather than all words. I think you are measuring both how generally moral the music is when you make ***all*** words the denominator, so differences would be hard to attribute to the concept of interest.\n\n## Basics\n\nFirst I'm going to run a MANOVA as a sanity check that difference of genre can reasonably be said to explain the difference in frequency of MFT words from one observation to the next. The output will show the summary statistics for each foundation, being basically equivalent to 5 ANOVAs. All are significant, though it is worth mentioning that Fairness already looks weaker than the rest. Response 1 = Harm/care, Response 2 = Fairness/cheating, Reponse 3 = Authority/subversion, Response 4 = Ingroup/betrayal, Response 5 = Purity/degradation.\n```{r}\nmanovaDV <- cbind((combined$HarmTotal/combined$TotalMoral), (combined$FairTotal/combined$TotalMoral), (combined$AuthTotal/combined$TotalMoral), (combined$IngTotal/combined$TotalMoral), (combined$PurityTotal/combined$TotalMoral));\nmanovafit <- manova(manovaDV ~ combined$genre);\nsummary.aov(manovafit, test=\"Pillai\");\n```\n\n\nNow I'm going to display a rank ordered list for each genre in each foundation. Remember that these numbers are the portion of all moral foundations words that reference the particular foundation. The first will be care/harm, so 0.5 means that half of all the lyrics that are in the MFT dictionary are references to care/harm.\n```{r}\nHarmTotSummary <- summarise(combined.grouped, TotHarmPer = (sum(HarmTotal)/sum(TotalMFT)));\narrange(HarmTotSummary,desc(TotHarmPer),genre)\n```\n\nIt is worth keeping in mind here that Care/harm is typically one of the least useful foundations for telling the difference between liberals and conservatives. Generally speaking, though, liberals are higher on Care/harm than conservatives, just very slightly. \n\n```{r}\nFairTotSummary <- summarise(combined.grouped, TotFairPer = (sum(FairTotal)/sum(TotalMFT)));\narrange(FairTotSummary,desc(TotFairPer),genre);\n```\n\nThese appear at an extremely low rate in the corpus. The threshold for significant mean differences between individual genres is around 0.01, though it depends on the number of words in the genres being compared.\n\n```{r}\nAuthTotSummary <- summarise(combined.grouped, TotAuthPer = (sum(AuthTotal)/sum(TotalMFT)));\narrange(AuthTotSummary,desc(TotAuthPer),genre);\n```\n\nAll of the genres typically perceived by the layperson as targeted to black audiences are above all the other genres when it comes to authority. This is very interesting, even if the reason isn't especially clear.\n\n```{r}\nIngTotSummary <- summarise(combined.grouped, TotIngPer = (sum(IngTotal)/sum(TotalMFT)));\narrange(IngTotSummary,desc(TotIngPer),genre);\n```\n\nA very similar pattern emerges here as with authority, with the notable exception of blues (which was tops in authority). I find it interesting that pop is dead last here, but it makes sense to me. Music that has broad appeal probably cannot be invested in appeals to ingroup moral considerations.\n\n```{r}\nPurityTotSummary <- summarise(combined.grouped, TotPurityPer = (sum(PurityTotal)/sum(TotalMFT)));\narrange(PurityTotSummary,desc(TotPurityPer),genre)\n```\n\nLast but not least, we have Purity, where Christian emerges as the top genre by far. This makes perfect sense, as does the presence of country at #2. \n\nBefore going further, the following will be the same set of summary statistics for each foundation with one change: instead of total occurrences of that foundation's words per all foundation words, the variable will be the ratio of \"virtue\" to \"vice\" words. This is meant to be a crude measure of foundation endorsement. There aren't radically different results so I won't offer any additional comments on it specifically.\n\n```{r}\nHarmRatioSummary <- summarise(combined.grouped, TotHarmRatio = (sum(HarmVirtue)/sum(HarmVice)));\narrange(HarmRatioSummary,desc(TotHarmRatio),genre);\n\nFairnessRatioSummary <- summarise(combined.grouped, TotFairnessRatio = (sum(FairnessVirtue)/sum(FairnessVice)));\narrange(FairnessRatioSummary,desc(TotFairnessRatio),genre);\n\nIngRatioSummary <- summarise(combined.grouped, TotIngRatio = (sum(IngroupVirtue)/sum(IngroupVice)));\narrange(IngRatioSummary,desc(TotIngRatio),genre);\n\nAuthRatioSummary <- summarise(combined.grouped, TotAuthRatio = (sum(AuthorityVirtue)/sum(AuthorityVice)));\narrange(AuthRatioSummary,desc(TotAuthRatio),genre);\n\nPurityRatioSummary <- summarise(combined.grouped, TotPurityRatio = (sum(PurityVirtue)/sum(PurityVice)));\narrange(PurityRatioSummary,desc(TotPurityRatio),genre)\n```\n#### Some thoughts\n\nThere is clearly *something* going on with these data and I think it is fair to assume that these differences across genres in terms of the moral content of lyrics are not coincidental. Too many of the patterns roughly conform to expectations. For purity, for instance, Christian and country music are above all others. High purity self-ratings is one of the best markers of conservatives, particularly social conservatives (libertarians rate very low on this foundation).\n\nIngroup loyalty may look anomalous given that this foundation is another that is typically associated with conservatives/Republicans. Jazz, followed by reggae and R&B/hip hop, are the genres which devote the largest portion of their moral lyrics to the ingroup loyalty foundation. Given that we know these audiences skew black and that black voters are overwhelmingly Democrats, this could be a surprise or even call into question the validity of the entire exercise. With that said, there are a couple of reasons this makes sense:\n\n* We know from other research areas that black people in the USA have a very high tendency, relative to other racial groups, to believe in \"linked fate\". This refers to the idea that what happens to some members of my (racial) group affects all members. This and certainly other indicators support the idea that black people in the USA have greater group cohesion and thus this type of language probably reflects that.\n* We'll see more of this in a moment, but our survey data shows a moral profile of black respondents that is very conservative. For genres associated with black audiences and performers to have these kinds of bread crumbs should be unalarming in that case.\n\nThe same observations could apply to the authority foundation for the second bullet point, but not so much the first. \n\nAnother thing to note is that while I have included the Fairness foundation in these analyses, a closer look shows that these words appear so infrequently that there are not always (statistically) significant differences between individual genres. The overall argument is that there is a societal impact from words that occur around once out of each 100 words; Fairness words appear around once out of each 500 words when averaging the genres. Some may bristle at the idea that we can learn something from it.\n\nOne last thing regarding linking the differences in these data to external data sources...there is almost no publicly available data linking music genre preferences to political or moral attitudes and absolutely none that I can find that is reasonably up to date or usable. There is a line of research linking preferences to loosely defined (not Big Five) personality traits with student samples. The Survey of Public Participation in the Arts has race/age/income types of data to link with music taste, but since it is collected by the Census Bureau they dare not ask about anything remotely controversial like political beliefs. The GSS is the best data source, but hasn't asked about music preference since 1992 and their genre categories are a mess, collapsing genres like pop and rock together as a single genre. Our own survey data may be one of a kind in many ways.\n\nWith that said, I can talk generally about the presumed differences in the audiences across genres, with country/Christian being obviously conservative and pop/rock having broadest reach. Given that liberals are so cosmopolitan and conservatives so narrow in their tastes, there aren't as many clear-cut \"liberal\" genres but our data shows R&B/hip hop, rap, and dance are all good candidates. \n\n# Peeking at survey data for these purposes\n\n## Looking at survey data\n\n**11/11 Note: I just realized that we made a somewhat meaningful change to half the MFT items by putting them on a 6-point scale instead of a 5-point scale. These analyses have been run as if they were all on the same scale. I've now applied a linear transformation to the 6-point items to make the responses seem to be on a 5-point scale. This allows to continue combining items into foundation sub-scores, which shouldn't be weighting half of the sub-score items more than others.**\n\n```{r}\ncondition <- surveydata[,44:65] > 6;\nsurveydata[,44:65][condition] <- NA;\nsixtofive <- function(x){\n  x <- (4/5)*x - (1/5);\n  return(x);\n}\nsurveydata[,44:54] <- sixtofive(surveydata[,44:54])\n```\n\nOkay, to begin with, I need to do a bunch of data cleaning to make it useful for these purposes. I'm going to leave the commented code here but I won't do much of any additional commentary on it for the sake of brevity. **Edit on 11/11: Added Cronbach's alpha calculations**\n\n```{r message=FALSE, warning=FALSE}\nlibrary(psy)\n# First, I need to add variables that keep each MFT subscore.\nsurveydata$MFQ_HARM_AVG = (surveydata$suffered+surveydata$cared_weak+surveydata$protect_animals+surveydata$compassion)/4;\nsurveydata$MFQ_FAIRNESS_AVG = (surveydata$act_unfair+surveydata$treated_diff+surveydata$justice+surveydata$fair_treatment)/4;\nsurveydata$MFQ_INGROUP_AVG = (surveydata$betrayal+surveydata$love_country+surveydata$proud_history+surveydata$family_loyalty)/4;\nsurveydata$MFQ_AUTHORITY_AVG = (surveydata$conformed+surveydata$lack_respect+surveydata$gender_roles+surveydata$respect)/4;\nsurveydata$MFQ_PURITY_AVG = (surveydata$disgusting+surveydata$no_decency+surveydata$disgusting2+surveydata$unnatural)/4;\nsurveydata$MFQ_PROGRESSIVISM_AVG = ((surveydata$MFQ_HARM_AVG+surveydata$MFQ_FAIRNESS_AVG)/2)-((surveydata$MFQ_INGROUP_AVG+surveydata$MFQ_AUTHORITY_AVG+surveydata$MFQ_PURITY_AVG)/3);\n\nsurveydata <- subset(surveydata, is.na(MFQ_HARM_AVG)==FALSE);\nsurveydata <- subset(surveydata, is.na(MFQ_PROGRESSIVISM_AVG)==FALSE);\n\n# Now I'm adding binary variables for conservative and liberal\nsurveydata$conservative[surveydata$ideo5==4] <- 1;\nsurveydata$conservative[surveydata$ideo5==5] <- 1;\nsurveydata$conservative[surveydata$ideo5==6] <- 0;\nsurveydata$conservative[surveydata$ideo5<4] <- 0;\nsurveydata$liberal[surveydata$ideo5<3] <- 1;\nsurveydata$liberal[surveydata$ideo5>2] <- 0;\nsurveydata$democrat[surveydata$pid3==1] <- 1;\nsurveydata$democrat[surveydata$pid3>1] <- 0;\nsurveydata$republican[surveydata$pid3==2] <- 1;\nsurveydata$republican[surveydata$pid3!=2] <- 0;\n\n# Creating separate data frames for each type of fan to look at their specific characteristics\nPopfans = subset(surveydata, (surveydata$like_Pop==4 | surveydata$like_Pop==5) & (surveydata$listen_Pop >= 3 & surveydata$listen_Pop < 6));\nCountryfans = subset(surveydata, (surveydata$like_Country==4 | surveydata$like_Country==5) & (surveydata$listen_Country >= 3 & surveydata$listen_Country < 6));\nChristianfans = subset(surveydata, (surveydata$like_Christian==4 | surveydata$like_Christian==5) & (surveydata$listen_Christian >= 3 & surveydata$listen_Christian < 6));\nRockfans = subset(surveydata, (surveydata$like_Rock==4 | surveydata$like_Rock==5) & (surveydata$listen_Rock >= 3 & surveydata$listen_Rock < 6));\nRapfans = subset(surveydata, (surveydata$like_Rap==4 | surveydata$like_Rap==5) & (surveydata$listen_Rap >= 3 & surveydata$listen_Rap < 6));\nDancefans = subset(surveydata, (surveydata$like_Dance==4 | surveydata$like_Dance==5) & (surveydata$listen_Dance >= 3 & surveydata$listen_Dance < 6));\nRbfans = subset(surveydata, (surveydata$like_R_n_B==4 | surveydata$like_R_n_B==5) & (surveydata$listen_R_n_B >= 3 & surveydata$listen_R_n_B < 6));\nReggaefans = subset(surveydata, (surveydata$like_Reggae ==4 | surveydata$like_Reggae == 5) & (surveydata$listen_Reggae >= 3 & surveydata$listen_Reggae < 6));\nBluesfans = subset(surveydata, (surveydata$like_Blues ==4 | surveydata$like_Blues == 5) & (surveydata$listen_Blues >= 3 & surveydata$listen_Blues < 6));\nJazzfans = subset(surveydata, (surveydata$like_Jazz ==4 | surveydata$like_Jazz == 5) & (surveydata$listen_Jazz >= 3 & surveydata$listen_Jazz < 6));\n\n# Creating a binary variable for each respondent where 1 is fan of a genre and 0 is not fan.\nsurveydata$Popfan[surveydata$like_Pop==4 | surveydata$like_Pop==5] <- 1; \nsurveydata$Popfan[surveydata$like_Pop !=4 & surveydata$like_Pop !=5] <- 0;\nsurveydata$Countryfan[surveydata$like_Country==4 | surveydata$like_Country==5] <- 1; \nsurveydata$Countryfan[surveydata$like_Country !=4 & surveydata$like_Country !=5] <- 0;\nsurveydata$Christianfan[surveydata$like_Christian==4 | surveydata$like_Christian==5] <- 1; \nsurveydata$Christianfan[surveydata$like_Christian !=4 & surveydata$like_Christian !=5] <- 0;\nsurveydata$Rockfan[surveydata$like_Rock==4 | surveydata$like_Rock==5] <- 1; \nsurveydata$Rockfan[surveydata$like_Rock !=4 & surveydata$like_Rock !=5] <- 0;\nsurveydata$Rapfan[surveydata$like_Rap==4 | surveydata$like_Rap==5] <- 1; \nsurveydata$Rapfan[surveydata$like_Rap !=4 & surveydata$like_Rap !=5] <- 0;\nsurveydata$Dancefan[surveydata$like_Dance==4 | surveydata$like_Dance==5] <- 1; \nsurveydata$Dancefan[surveydata$like_Dance !=4 & surveydata$like_Dance !=5] <- 0;\nsurveydata$Rbfan[surveydata$like_R_n_B==4 | surveydata$like_R_n_B==5] <- 1; \nsurveydata$Rbfan[surveydata$like_R_n_B !=4 & surveydata$like_R_n_B !=5] <- 0;\nsurveydata$Reggaefan[surveydata$like_Reggae==4 | surveydata$like_Reggae==5] <- 1; \nsurveydata$Reggaefan[surveydata$like_Reggae !=4 & surveydata$like_Reggae !=5] <- 0;\nsurveydata$Bluesfan[surveydata$like_Blues==4 | surveydata$like_Blues==5] <- 1; \nsurveydata$Bluesfan[surveydata$like_Blues !=4 & surveydata$like_Blues !=5] <- 0;\nsurveydata$Jazzfan[surveydata$like_Jazz==4 | surveydata$like_Jazz==5] <- 1; \nsurveydata$Jazzfan[surveydata$like_Jazz !=4 & surveydata$like_Jazz !=5] <- 0;\nsurveydata$genresliked <- surveydata$Popfan+surveydata$Rockfan+surveydata$Christianfan+surveydata$Countryfan+surveydata$Rapfan+surveydata$Dancefan+surveydata$Rbfan+surveydata$Reggaefan+surveydata$Bluesfan+surveydata$Jazzfan;\n\n# I'm going to recode some variables as missing, so I first will create a duplicate survey dataset\nsurveydata2 <- surveydata;\n# Now I'm going to recode don't know/other answers in the ideo5 and pid3 variables as missing for the sake of presenting things clearly\nsurveydata2$ideo5[surveydata2$ideo5==6] <- NA;\nsurveydata2$pid3[surveydata2$pid3>2] <- NA;\n# Here I'm going to reshape some data to graph differences in MFT ratings by ideological self-description\nsurveydatameansbyideo5 <- aggregate(surveydata2, data=surveydata2, by=list(ideo5=surveydata2$ideo5), FUN=\"mean\");\nsurveydatameansbypid3 <- aggregate(surveydata2, data=surveydata2, by=list(pid3=surveydata2$pid3), FUN=\"mean\");\nsdmeansbyid5melt <- melt(surveydatameansbyideo5, id.vars=c(\"ideo5\"), measure.vars = c(\"MFQ_HARM_AVG\", \"MFQ_FAIRNESS_AVG\", \"MFQ_INGROUP_AVG\", \"MFQ_AUTHORITY_AVG\", \"MFQ_PURITY_AVG\"));\nsdmeansbyid5melt$ideo5 <- factor(sdmeansbyid5melt$ideo5, levels=c(1,2,3,4,5), labels=c(\"Very liberal\", \"Liberal\", \"Moderate\", \"Conservative\", \"Very conservative\"));\n\n# Going to add a genre variable to each subset so I can then combine them into a single dataframe for ease of analysis\nPopfans$genre = \"pop\";Countryfans$genre = \"country\";Christianfans$genre = \"christian\";Rockfans$genre = \"rock\";\nRapfans$genre = \"rap\";Rbfans$genre = \"rbhiphop\";Dancefans$genre = \"dance\";Reggaefans$genre = \"reggae\";\nBluesfans$genre = \"blues\";Jazzfans$genre = \"jazz\";\n# Now I combine them into one dataset\nallfans <- rbind(Popfans,Countryfans,Christianfans,Rockfans,Rapfans,Rbfans,Dancefans,Reggaefans,Bluesfans,Jazzfans);\n# Now, much like with the lyrics data, I make another table containing the MFT means for each genre's fans\nfangenremeans <- aggregate(allfans, data=allfans, by=list(genre=allfans$genre), FUN=\"mean\");\n\n# First a brief exploration of the moral differences of each genre's fans\nfangenremeansmelt <- melt(fangenremeans[c(\"genre\", \"MFQ_HARM_AVG\", \"MFQ_FAIRNESS_AVG\", \"MFQ_INGROUP_AVG\", \"MFQ_AUTHORITY_AVG\", \"MFQ_PURITY_AVG\")]);\n\n# Now I'm going to join the fan data with the lyric data for further analysis\njoinedmeans <- cbind(fangenremeans, genremeans);\n```\n\n\nTo understand the differences we're looking for, it will be useful to understand how moral foundations differ across ideologies. While this is well-established in the literature, our dataset is a stunningly close replication of the 2009 Graham, Haidt, and Nosek study that first linked MFT and political ideology. This is very cool!\n\nHere's one visual representation of averages on all 5 foundations separated by ideological self-description\n```{r}\nMFTratesbyideo5plot <- ggplot(data=sdmeansbyid5melt, aes(x=variable, y=value, fill=variable)) + geom_bar(stat=\"identity\") + facet_wrap(~ideo5) + ylab(\"Average self-rating out of 5\") + xlab(\"Foundation\") + theme(axis.text.x=element_blank());\nprint(MFTratesbyideo5plot);\n```\n\nHere is a line plot of the same, which is much clearer in my opinion and very closely mirrors the line graphs in Graham, Haidt, and Nosek (2009),\n```{r}\nMFTratesbyideo5lineplot <- ggplot(data=sdmeansbyid5melt, aes(x=ideo5, y=value, color=variable, group=variable)) + geom_line(stat=\"identity\") + geom_point(aes(shape=variable));\nprint(MFTratesbyideo5lineplot);\n```\n\nNow let's look at the MFT ratings for fans of each genre rather than by ideology (which is interesting, but not as crucial given that it merely confirms past finddings).\n```{r}\nMFTratesbygenreplot <- ggplot(data=fangenremeansmelt, aes(x = variable, y = value, fill = variable)) + geom_bar(stat=\"identity\") + facet_wrap(~genre) + coord_cartesian(ylim=c(2.5,4.5)) + theme(axis.text.x = element_blank()) + xlab(\"Foundations\") + ylab(\"Average rating out of 5\");\nprint(MFTratesbygenreplot);\n```\n\nThis following graph splits things up by foundation, instead.\n```{r}\nMFTratesbyfoundationplot <- ggplot(data=fangenremeansmelt, aes(x = genre, y = value, fill = genre)) + geom_bar(stat=\"identity\") + facet_wrap(~variable) + coord_cartesian(ylim=c(2.5,4.5)) + theme(axis.text.x = element_blank()) + xlab(\"genre\") + ylab(\"Average rating out of 5\");\nprint(MFTratesbyfoundationplot);\n```\n\nLet's see if there's much concordance between fan morality and lyric morality. What follows are a series of correlations for an n=10 dataset in which each row is a genre and some variables are word count averages and other variables are survey response averages of people who are fans of that genre. I then plot those points just to give a sense of the spread.\n\n```{r message=FALSE}\nlibrary(Hmisc);\nrcorr(joinedmeans$PurityTotPer, joinedmeans$MFQ_PURITY_AVG, type=\"pearson\");\npcorplot <- qplot(data=joinedmeans, x=PurityTotPer, y=MFQ_PURITY_AVG) + stat_smooth(method = lm, se=FALSE);\nprint(pcorplot);\n```\n\nPurity appears quite meaningful, as expected, but you can tell from the plot that we have a very influential variable. That is Christian music. \n\n```{r}\nrcorr(joinedmeans$FairTotPer, joinedmeans$MFQ_FAIRNESS_AVG, type=\"pearson\");\nicorplot <- qplot(data=joinedmeans, x=FairTotPer, y=MFQ_FAIRNESS_AVG) + stat_smooth(method = lm, se=FALSE);\nprint(icorplot);\n```\n\nNot much going on here.\n\n```{r}\nrcorr(joinedmeans$IngTotPer, joinedmeans$MFQ_INGROUP_AVG, type=\"pearson\");\nicorplot <- qplot(data=joinedmeans, x=IngTotPer, y=MFQ_INGROUP_AVG) + stat_smooth(method = lm, se=FALSE);\nprint(icorplot);\n```\n\nNot much going on here.\n\n```{r}\nrcorr(joinedmeans$AuthTotPer, joinedmeans$MFQ_AUTHORITY_AVG, type=\"pearson\");\nacorplot <- qplot(data=joinedmeans, x=AuthTotPer, y=MFQ_AUTHORITY_AVG) + stat_smooth(method = lm, se=FALSE);\nprint(acorplot);\n```\n\nNot much going on here.\n\n```{r}\nrcorr(joinedmeans$HarmTotPer, joinedmeans$MFQ_HARM_AVG, type=\"pearson\");\nhcorplot <- qplot(data=joinedmeans, x=HarmTotPer, y=MFQ_HARM_AVG) + stat_smooth(method = lm, se=FALSE);\nprint(hcorplot);\n```\n\nThis is to be expected given that there is relatively very little variation in endorsement of the harm foundation among Americans.\n\nNext is the same set of correlations, but with the Virtue:Vice ratio for each foundation in place of the total proportion of occurrences. There is nothing remarkable in these results.\n```{r}\nrcorr(joinedmeans$PurityRatio, joinedmeans$MFQ_PURITY_AVG, type=\"pearson\");\npcorplot <- qplot(data=joinedmeans, x=PurityRatio, y=MFQ_PURITY_AVG) + stat_smooth(method=lm, se=FALSE);\nprint(pcorplot);\n```\nOnce again, lots of concordance between Purity in the lyrics and Purity endorsement among fans. This is nice at least in part because it is not confounded by the religious undertones (and overtones) of many of the words in the Purity dictionary. \n```{r}\nrcorr(joinedmeans$FairRatio, joinedmeans$MFQ_FAIRNESS_AVG, type=\"pearson\");\nrcorr(joinedmeans$IngRatio, joinedmeans$MFQ_INGROUP_AVG, type=\"pearson\");\nrcorr(joinedmeans$AuthRatio, joinedmeans$MFQ_AUTHORITY_AVG, type=\"pearson\");\nrcorr(joinedmeans$HarmRatio, joinedmeans$MFQ_HARM_AVG, type=\"pearson\");\n```\nNot a great deal of difference in these other correlations when you swap foundation/MFT words with Virtue:Vice ratio. Fairness does lose its predictive power.\n\nTo account for the joint impact of each foundation's amount of occurrences *and* the ratio of Virtue:Vice (which is thought to be a crude indicator of endorsement), I have below a series of simple linear regression models to examine those relationships. \n```{r}\nfit1 <- lm(MFQ_PURITY_AVG ~ PurityTotPer + PurityRatio, data = joinedmeans);\nsummary(fit1);\n```\n\nUnsurprisingly, it's the same story for Purity. \n\n```{r}\nfit2 <- lm(MFQ_FAIRNESS_AVG ~ FairTotPer + FairRatio, data = joinedmeans);\nsummary(fit2);  \nfit3 <- lm(MFQ_AUTHORITY_AVG ~ AuthTotPer + AuthRatio, data = joinedmeans);\nsummary(fit3);\nfit4 <- lm(MFQ_INGROUP_AVG ~ IngTotPer + IngRatio, data = joinedmeans);\nsummary(fit4);\nfit5 <- lm(MFQ_HARM_AVG ~ HarmTotPer + HarmRatio, data = joinedmeans);\nsummary(fit5);\n```\n\nAnd again, no added benefit of combining both measures for the other foundations.\n\nWith all this rich survey information though, why not do a more holistic measure? Taking together the moral characteristics of the music genre, can we create a model that predicts what portion of that genre's fans are political liberals?\n\nThis first model has the Purity rate, Authority rate, Ingroup rate, and Harm rate (out of all MFT words) as predictors. The portion of the genre's fans that answered \"liberal\" or \"very liberal\" on the 5-point scale is the DV. \n```{r}\nfit5 <- lm(conservative ~ PurityTotPer + AuthTotPer + IngTotPer + HarmTotPer, data=joinedmeans);\nsummary(fit5);\n```\nWell that's enlightening! The combination of all moral foundations predicts the portion of the genre's fanbase that is conservative. No significant predictor, unfortunately, though we can see Purity is close.\n\nTo look at the same question, but with \"Democrat\" in place of \"liberal\"...\n```{r}\nfit6 <- lm(republican ~ PurityTotPer + AuthTotPer + IngTotPer + HarmTotPer, data=joinedmeans);\nsummary(fit6);\n```\n\nFindings are not as strong, which is to be expected given that the leap from ideology to party ID is yet another level of abstraction away.\n\nI think this slightly larger model (with \"liberal\" as DV) is pretty provocative, though there will be complaints about low N that would be justified.\n\n# Summarizing\n\nIt's all about Purity/degradation, it seems. Our two bona fide conservative genres, Christian and country, are above the rest here. This applies to the descriptive content analysis portion and is borne out when integrating the survey data as well.\n\nPop music also makes for a good exemplar. It is the genre with presumably broadest appeal (our dataset suggest rock has the largest number of fans) and is high on the foundations that aren't polarizing and at or below average on the foundations that appeal moreso to conservatives. Rock is very near to the mean on all foundations, which also makes perfect sense. \n\nThe obvious weakness with this analysis is that mentions do not mean endorsement. I don't think the Vice and Virtue distinction does much to fix the issue, either. One research group coded a random sample with human coders to establish rates of endorsement of foundations. Still, I think there is something to be learned from this, even if we have a crude measure.\n\n# November 5th Updated Analyses w/ Nov. 9th updates\nHere is my work with creating weighted z-score variables to quantify the moral content of liked musical genres for each individual in the survey. I'll summarize the process of creating these variables below.\n\nFor the output to work right, I have to leave the entire large block of code in one piece. I will take a snippet and explain what everything is doing. I will then hide the large block of code which just does the same thing for each genre for the sake of navigability.\n\n**11/9 change: Eliminated the double weight for \"really like\" responses**\nFirst, I see if the respondent said they \"like\" or \"really like\" the genre, in this case it is pop. If the answer is yes, then the code executes. If not, it skips on to the next block of code.\n```{r eval=FALSE}\n  if (surveydata$like_Pop[surveydata$id==x] > 3 & surveydata$like_Pop[surveydata$id==x] < 6)\n```\n\n**11/11 change: Added a \"progressivism\" measure**\nAssuming the answer is yes, I now store that genre's z-scores for each foundation in a vector.\n```{r eval=FALSE}\n{\n    harmvec <- c(harmvec, genremeans$HarmZ2[genremeans$genre==\"pop\"]);\n    fairvec <- c(fairvec, genremeans$FairZ2[genremeans$genre==\"pop\"]);\n    ingvec <- c(ingvec, genremeans$IngZ2[genremeans$genre==\"pop\"]);\n    authvec <- c(authvec, genremeans$AuthZ2[genremeans$genre==\"pop\"]);\n    purityvec <- c(purityvec, genremeans$PurityZ2[genremeans$genre==\"pop\"]);\n    progvec <- c(progvec, genremeans$ProgressivismTotal[genremeans$genre==\"pop\"]);\n    \n```\n   \nNext, I add a value for the weighting of z-scores into a new vector based on how much the respondent reports listening to that genre. The value is 1 if they said they listen less than once a week, 2 if one to three times per week, and 4 if most days of the week. If they listen less frequently, the weight is 0, effectively taking this genre out of that respondent's weighted average. Remember this code only runs if the respondent said they like the genre, so they must like it and listen to it for it to contribute to their weighted average.   \n```{r eval=FALSE}    \n    if (surveydata$listen_Pop[surveydata$id==x] == 3) weightvec <- c(weightvec, 1);\n    if (surveydata$listen_Pop[surveydata$id==x] == 4) weightvec <- c(weightvec, 2);\n    if (surveydata$listen_Pop[surveydata$id==x] == 5) weightvec <- c(weightvec, 4);\n    if (surveydata$listen_Pop[surveydata$id==x] < 3 | surveydata$listen_Pop[surveydata$id==x] > 5) weightvec <- c(weightvec, 0);\n```\n\nLastly, I set a variable for whether they are a fan of that genre to 1 if they both like it and listen to it at least once per month. This just allows me to filter out the few people who report being fans of zero genres in future analyses.\n```{r eval=FALSE}\n    if (surveydata$listen_Pop[surveydata$id==x] < 3 | surveydata$listen_Pop[surveydata$id==x] > 5) surveydata$Popfan[surveydata$id==x] <- 0\n    else surveydata$Popfan[surveydata$id==x] <- 1;\n    \n  };\n```\n\n\n\nAfter equivalent code runs for all 10 genres, there will be vectors containing the values of each liked genre's lyric z-score for each foundation. A sixth vector will contain weight values for each of the z-scores. The final step is to calculate a weighted average for each foundation for each respondent, which is interpreted as a z-score. \n\nJust as a note, I tinkered with the weight values and they just didn't substantively affect the outcomes no matter what I did. The final product is merely just what I felt made the most sense conceptually.\n\n```{r echo=FALSE} \n# Purely for aesthetic reasons, don't worry about this\nsurveydata$id <- row.names(surveydata);\n\n# Loops through each observation, performing same set of operations on each\nrows <- c(surveydata$id)\nfor (x in rows) {\n  \n  harmvec <- c();\n  fairvec <- c();\n  ingvec <- c();\n  authvec <- c();\n  purityvec <- c();\n  progvec <- c();\n  negvec <- c();\n  posvec <- c();\n  religvec <- c();\n  \n  weightvec <- c();\n  \n  if (surveydata$like_Pop[surveydata$id==x] > 3 & surveydata$like_Pop[surveydata$id==x] < 6) {\n    harmvec <- c(harmvec, genremeans$HarmZ2[genremeans$genre==\"pop\"]);\n    fairvec <- c(fairvec, genremeans$FairZ2[genremeans$genre==\"pop\"]);\n    ingvec <- c(ingvec, genremeans$IngZ2[genremeans$genre==\"pop\"]);\n    authvec <- c(authvec, genremeans$AuthZ2[genremeans$genre==\"pop\"]);\n    purityvec <- c(purityvec, genremeans$PurityZ2[genremeans$genre==\"pop\"]);\n    negvec <- c(negvec, genremeans$negemo[genremeans$genre==\"pop\"]);\n    posvec <- c(posvec, genremeans$posemo[genremeans$genre==\"pop\"]);\n    religvec <- c(religvec, genremeans$relig[genremeans$genre==\"pop\"]);\n    progvec <- c(progvec, genremeans$ProgressivismTotal[genremeans$genre==\"pop\"]);\n    \n    if (surveydata$listen_Pop[surveydata$id==x] == 3) weightvec <- c(weightvec, 1);\n    if (surveydata$listen_Pop[surveydata$id==x] == 4) weightvec <- c(weightvec, 2);\n    if (surveydata$listen_Pop[surveydata$id==x] == 5) weightvec <- c(weightvec, 4);\n    if (surveydata$listen_Pop[surveydata$id==x] < 3 | surveydata$listen_Pop[surveydata$id==x] > 5) weightvec <- c(weightvec, 0);\n    \n    if (surveydata$listen_Pop[surveydata$id==x] < 3 | surveydata$listen_Pop[surveydata$id==x] > 5) surveydata$Popfan[surveydata$id==x] <- 0\n    else surveydata$Popfan[surveydata$id==x] <- 1;\n    \n  };\n  \n  if (surveydata$like_Country[surveydata$id==x] > 3 & surveydata$like_Country[surveydata$id==x] < 6) {\n    harmvec <- c(harmvec, genremeans$HarmZ2[genremeans$genre==\"country\"]);\n    fairvec <- c(fairvec, genremeans$FairZ2[genremeans$genre==\"country\"]);\n    ingvec <- c(ingvec, genremeans$IngZ2[genremeans$genre==\"country\"]);\n    authvec <- c(authvec, genremeans$AuthZ2[genremeans$genre==\"country\"]);\n    purityvec <- c(purityvec, genremeans$PurityZ2[genremeans$genre==\"country\"]);\n    negvec <- c(negvec, genremeans$negemo[genremeans$genre==\"country\"]);\n    posvec <- c(posvec, genremeans$posemo[genremeans$genre==\"country\"]);\n    religvec <- c(religvec, genremeans$relig[genremeans$genre==\"country\"]);\n    progvec <- c(progvec, genremeans$ProgressivismTotal[genremeans$genre==\"country\"]);\n    \n    if (surveydata$listen_Country[surveydata$id==x] == 3) weightvec <- c(weightvec, 1);\n    if (surveydata$listen_Country[surveydata$id==x] == 4) weightvec <- c(weightvec, 2);\n    if (surveydata$listen_Country[surveydata$id==x] == 5) weightvec <- c(weightvec, 4);\n    if (surveydata$listen_Country[surveydata$id==x] < 3 | surveydata$listen_Country[surveydata$id==x] > 5) weightvec <- c(weightvec, 0);\n    \n    if (surveydata$listen_Country[surveydata$id==x] < 3 | surveydata$listen_Country[surveydata$id==x] > 5) surveydata$Countryfan[surveydata$id==x] <- 0\n    else surveydata$Countryfan[surveydata$id==x] <- 1;\n  };\n  \n  if (surveydata$like_Rock[surveydata$id==x] > 3 & surveydata$like_Rock[surveydata$id==x] < 6) {\n    harmvec <- c(harmvec, genremeans$HarmZ2[genremeans$genre==\"rock\"]);\n    fairvec <- c(fairvec, genremeans$FairZ2[genremeans$genre==\"rock\"]);\n    ingvec <- c(ingvec, genremeans$IngZ2[genremeans$genre==\"rock\"]);\n    authvec <- c(authvec, genremeans$AuthZ2[genremeans$genre==\"rock\"]);\n    purityvec <- c(purityvec, genremeans$PurityZ2[genremeans$genre==\"rock\"]);\n    negvec <- c(negvec, genremeans$negemo[genremeans$genre==\"rock\"]);\n    posvec <- c(posvec, genremeans$posemo[genremeans$genre==\"rock\"]);\n    religvec <- c(religvec, genremeans$relig[genremeans$genre==\"rock\"]);\n    progvec <- c(progvec, genremeans$ProgressivismTotal[genremeans$genre==\"rock\"]);\n    \n    if (surveydata$listen_Rock[surveydata$id==x] == 3) weightvec <- c(weightvec, 1);\n    if (surveydata$listen_Rock[surveydata$id==x] == 4) weightvec <- c(weightvec, 2);\n    if (surveydata$listen_Rock[surveydata$id==x] == 5) weightvec <- c(weightvec, 4);\n    if (surveydata$listen_Rock[surveydata$id==x] < 3 | surveydata$listen_Rock[surveydata$id==x] > 5) weightvec <- c(weightvec, 0);\n    if (surveydata$listen_Rock[surveydata$id==x] < 3 | surveydata$listen_Rock[surveydata$id==x] > 5) surveydata$Rockfan[surveydata$id==x] <- 0\n    else surveydata$Rockfan[surveydata$id==x] <- 1;\n  };\n  \n  \n  if (surveydata$like_R_n_B[surveydata$id==x] > 3 & surveydata$like_R_n_B[surveydata$id==x] < 6) {\n    harmvec <- c(harmvec, genremeans$HarmZ2[genremeans$genre==\"rbhiphop\"]);\n    fairvec <- c(fairvec, genremeans$FairZ2[genremeans$genre==\"rbhiphop\"]);\n    ingvec <- c(ingvec, genremeans$IngZ2[genremeans$genre==\"rbhiphop\"]);\n    authvec <- c(authvec, genremeans$AuthZ2[genremeans$genre==\"rbhiphop\"]);\n    purityvec <- c(purityvec, genremeans$PurityZ2[genremeans$genre==\"rbhiphop\"]);\n    negvec <- c(negvec, genremeans$negemo[genremeans$genre==\"rbhiphop\"]);\n    posvec <- c(posvec, genremeans$posemo[genremeans$genre==\"rbhiphop\"]);\n    religvec <- c(religvec, genremeans$relig[genremeans$genre==\"rbhiphop\"]);\n    progvec <- c(progvec, genremeans$ProgressivismTotal[genremeans$genre==\"rbhiphop\"]);\n    \n    if (surveydata$listen_R_n_B[surveydata$id==x] == 3) weightvec <- c(weightvec, 1);\n    if (surveydata$listen_R_n_B[surveydata$id==x] == 4) weightvec <- c(weightvec, 2);\n    if (surveydata$listen_R_n_B[surveydata$id==x] == 5) weightvec <- c(weightvec, 4);\n    if (surveydata$listen_R_n_B[surveydata$id==x] < 3 | surveydata$listen_R_n_B[surveydata$id==x] > 5) weightvec <- c(weightvec, 0);\n    if (surveydata$listen_R_n_B[surveydata$id==x] < 3 | surveydata$listen_R_n_B[surveydata$id==x] > 5) surveydata$Rbfan[surveydata$id==x] <- 0\n    else surveydata$Rbfan[surveydata$id==x] <- 1;\n  };\n  \n  if (surveydata$like_Rap[surveydata$id==x] > 3 & surveydata$like_Rap[surveydata$id==x] < 6) {\n    harmvec <- c(harmvec, genremeans$HarmZ2[genremeans$genre==\"rap\"]);\n    fairvec <- c(fairvec, genremeans$FairZ2[genremeans$genre==\"rap\"]);\n    ingvec <- c(ingvec, genremeans$IngZ2[genremeans$genre==\"rap\"]);\n    authvec <- c(authvec, genremeans$AuthZ2[genremeans$genre==\"rap\"]);\n    purityvec <- c(purityvec, genremeans$PurityZ2[genremeans$genre==\"rap\"]);\n    negvec <- c(negvec, genremeans$negemo[genremeans$genre==\"rap\"]);\n    posvec <- c(posvec, genremeans$posemo[genremeans$genre==\"rap\"]);\n    religvec <- c(religvec, genremeans$relig[genremeans$genre==\"rap\"]);\n    progvec <- c(progvec, genremeans$ProgressivismTotal[genremeans$genre==\"rap\"]);\n    \n    if (surveydata$listen_Rap[surveydata$id==x] == 3) weightvec <- c(weightvec, 1);\n    if (surveydata$listen_Rap[surveydata$id==x] == 4) weightvec <- c(weightvec, 2);\n    if (surveydata$listen_Rap[surveydata$id==x] == 5) weightvec <- c(weightvec, 4);\n    if (surveydata$listen_Rap[surveydata$id==x] < 3 | surveydata$listen_Rap[surveydata$id==x] > 5) weightvec <- c(weightvec, 0);\n    if (surveydata$listen_Rap[surveydata$id==x] < 3 | surveydata$listen_Rap[surveydata$id==x] > 5) surveydata$Rapfan[surveydata$id==x] <- 0\n    else surveydata$Rapfan[surveydata$id==x] <- 1;\n  };\n  \n  if (surveydata$like_Dance[surveydata$id==x] > 3 & surveydata$like_Dance[surveydata$id==x] < 6) {\n    harmvec <- c(harmvec, genremeans$HarmZ2[genremeans$genre==\"dance\"]);\n    fairvec <- c(fairvec, genremeans$FairZ2[genremeans$genre==\"dance\"]);\n    ingvec <- c(ingvec, genremeans$IngZ2[genremeans$genre==\"dance\"]);\n    authvec <- c(authvec, genremeans$AuthZ2[genremeans$genre==\"dance\"]);\n    purityvec <- c(purityvec, genremeans$PurityZ2[genremeans$genre==\"dance\"]);\n    negvec <- c(negvec, genremeans$negemo[genremeans$genre==\"dance\"]);\n    posvec <- c(posvec, genremeans$posemo[genremeans$genre==\"dance\"]);\n    religvec <- c(religvec, genremeans$relig[genremeans$genre==\"dance\"]);\n    progvec <- c(progvec, genremeans$ProgressivismTotal[genremeans$genre==\"dance\"]);\n    \n    if (surveydata$listen_Dance[surveydata$id==x] == 3) weightvec <- c(weightvec, 1);\n    if (surveydata$listen_Dance[surveydata$id==x] == 4) weightvec <- c(weightvec, 2);\n    if (surveydata$listen_Dance[surveydata$id==x] == 5) weightvec <- c(weightvec, 4);\n    if (surveydata$listen_Dance[surveydata$id==x] < 3 | surveydata$listen_Dance[surveydata$id==x] > 5) weightvec <- c(weightvec, 0);\n    if (surveydata$listen_Dance[surveydata$id==x] < 3 | surveydata$listen_Dance[surveydata$id==x] > 5) surveydata$Dancefan[surveydata$id==x] <- 0\n    else surveydata$Dancefan[surveydata$id==x] <- 1;\n  };\n  \n  if (surveydata$like_Christian[surveydata$id==x] > 3 & surveydata$like_Christian[surveydata$id==x] < 6) {\n    harmvec <- c(harmvec, genremeans$HarmZ2[genremeans$genre==\"christian\"]);\n    fairvec <- c(fairvec, genremeans$FairZ2[genremeans$genre==\"christian\"]);\n    ingvec <- c(ingvec, genremeans$IngZ2[genremeans$genre==\"christian\"]);\n    authvec <- c(authvec, genremeans$AuthZ2[genremeans$genre==\"christian\"]);\n    purityvec <- c(purityvec, genremeans$PurityZ2[genremeans$genre==\"christian\"]);\n    negvec <- c(negvec, genremeans$negemo[genremeans$genre==\"christian\"]);\n    posvec <- c(posvec, genremeans$posemo[genremeans$genre==\"christian\"]);\n    religvec <- c(religvec, genremeans$relig[genremeans$genre==\"christian\"]);\n    progvec <- c(progvec, genremeans$ProgressivismTotal[genremeans$genre==\"christian\"]);\n    \n    if (surveydata$listen_Christian[surveydata$id==x] == 3) weightvec <- c(weightvec, 1);\n    if (surveydata$listen_Christian[surveydata$id==x] == 4) weightvec <- c(weightvec, 2);\n    if (surveydata$listen_Christian[surveydata$id==x] == 5) weightvec <- c(weightvec, 4);\n    if (surveydata$listen_Christian[surveydata$id==x] < 3 | surveydata$listen_Christian[surveydata$id==x] > 5) weightvec <- c(weightvec, 0);\n    if (surveydata$listen_Christian[surveydata$id==x] < 3 | surveydata$listen_Christian[surveydata$id==x] > 5) surveydata$Christianfan[surveydata$id==x] <- 0\n    else surveydata$Christianfan[surveydata$id==x] <- 1;\n  };\n  \n  if (surveydata$like_Jazz[surveydata$id==x] > 3 & surveydata$like_Jazz[surveydata$id==x] < 6) {\n    harmvec <- c(harmvec, genremeans$HarmZ2[genremeans$genre==\"jazz\"]);\n    fairvec <- c(fairvec, genremeans$FairZ2[genremeans$genre==\"jazz\"]);\n    ingvec <- c(ingvec, genremeans$IngZ2[genremeans$genre==\"jazz\"]);\n    authvec <- c(authvec, genremeans$AuthZ2[genremeans$genre==\"jazz\"]);\n    purityvec <- c(purityvec, genremeans$PurityZ2[genremeans$genre==\"jazz\"]);\n    negvec <- c(negvec, genremeans$negemo[genremeans$genre==\"jazz\"]);\n    posvec <- c(posvec, genremeans$posemo[genremeans$genre==\"jazz\"]);\n    religvec <- c(religvec, genremeans$relig[genremeans$genre==\"jazz\"]);\n    progvec <- c(progvec, genremeans$ProgressivismTotal[genremeans$genre==\"jazz\"]);\n    \n    if (surveydata$listen_Jazz[surveydata$id==x] == 3) weightvec <- c(weightvec, 1);\n    if (surveydata$listen_Jazz[surveydata$id==x] == 4) weightvec <- c(weightvec, 2);\n    if (surveydata$listen_Jazz[surveydata$id==x] == 5) weightvec <- c(weightvec, 4);\n    if (surveydata$listen_Jazz[surveydata$id==x] < 3 | surveydata$listen_Jazz[surveydata$id==x] > 5) weightvec <- c(weightvec, 0);\n    if (surveydata$listen_Jazz[surveydata$id==x] < 3 | surveydata$listen_Jazz[surveydata$id==x] > 5) surveydata$Jazzfan[surveydata$id==x] <- 0\n    else surveydata$Jazzfan[surveydata$id==x] <- 1;\n  };\n  \n  if (surveydata$like_Reggae[surveydata$id==x] > 3 & surveydata$like_Reggae[surveydata$id==x] < 6) {\n    harmvec <- c(harmvec, genremeans$HarmZ2[genremeans$genre==\"reggae\"]);\n    fairvec <- c(fairvec, genremeans$FairZ2[genremeans$genre==\"reggae\"]);\n    ingvec <- c(ingvec, genremeans$IngZ2[genremeans$genre==\"reggae\"]);\n    authvec <- c(authvec, genremeans$AuthZ2[genremeans$genre==\"reggae\"]);\n    purityvec <- c(purityvec, genremeans$PurityZ2[genremeans$genre==\"reggae\"]);\n    negvec <- c(negvec, genremeans$negemo[genremeans$genre==\"reggae\"]);\n    posvec <- c(posvec, genremeans$posemo[genremeans$genre==\"reggae\"]);\n    religvec <- c(religvec, genremeans$relig[genremeans$genre==\"reggae\"]);\n    progvec <- c(progvec, genremeans$ProgressivismTotal[genremeans$genre==\"reggae\"]);\n    \n    if (surveydata$listen_Reggae[surveydata$id==x] == 3) weightvec <- c(weightvec, 1);\n    if (surveydata$listen_Reggae[surveydata$id==x] == 4) weightvec <- c(weightvec, 2);\n    if (surveydata$listen_Reggae[surveydata$id==x] == 5) weightvec <- c(weightvec, 4);\n    if (surveydata$listen_Reggae[surveydata$id==x] < 3 | surveydata$listen_Reggae[surveydata$id==x] > 5) weightvec <- c(weightvec, 0);\n    if (surveydata$listen_Reggae[surveydata$id==x] < 3 | surveydata$listen_Reggae[surveydata$id==x] > 5) surveydata$Reggaefan[surveydata$id==x] <- 0\n    else surveydata$Reggaefan[surveydata$id==x] <- 1;\n  };\n  \n  if (surveydata$like_Blues[surveydata$id==x] > 3 & surveydata$like_Pop[surveydata$id==x] < 6) {\n    harmvec <- c(harmvec, genremeans$HarmZ2[genremeans$genre==\"blues\"]);\n    fairvec <- c(fairvec, genremeans$FairZ2[genremeans$genre==\"blues\"]);\n    ingvec <- c(ingvec, genremeans$IngZ2[genremeans$genre==\"blues\"]);\n    authvec <- c(authvec, genremeans$AuthZ2[genremeans$genre==\"blues\"]);\n    purityvec <- c(purityvec, genremeans$PurityZ2[genremeans$genre==\"blues\"]);\n    negvec <- c(negvec, genremeans$negemo[genremeans$genre==\"blues\"]);\n    posvec <- c(posvec, genremeans$posemo[genremeans$genre==\"blues\"]);\n    religvec <- c(religvec, genremeans$relig[genremeans$genre==\"blues\"]);\n    progvec <- c(progvec, genremeans$ProgressivismTotal[genremeans$genre==\"blues\"]);\n    \n    if (surveydata$listen_Blues[surveydata$id==x] == 3) weightvec <- c(weightvec, 1);\n    if (surveydata$listen_Blues[surveydata$id==x] == 4) weightvec <- c(weightvec, 2);\n    if (surveydata$listen_Blues[surveydata$id==x] == 5) weightvec <- c(weightvec, 4);\n    if (surveydata$listen_Blues[surveydata$id==x] < 3 | surveydata$listen_Blues[surveydata$id==x] > 5) weightvec <- c(weightvec, 0);\n    if (surveydata$listen_Blues[surveydata$id==x] < 3 | surveydata$listen_Blues[surveydata$id==x] > 5) surveydata$Bluesfan[surveydata$id==x] <- 0\n    else surveydata$Bluesfan[surveydata$id==x] <- 1;\n  };\n  \n  surveydata$lyricharmZ[surveydata$id==x] <- weighted.mean(harmvec, weightvec);\n  surveydata$lyricfairZ[surveydata$id==x] <- weighted.mean(fairvec, weightvec);\n  surveydata$lyricingZ[surveydata$id==x] <- weighted.mean(ingvec, weightvec);\n  surveydata$lyricauthZ[surveydata$id==x] <- weighted.mean(authvec, weightvec);\n  surveydata$lyricpurityZ[surveydata$id==x] <- weighted.mean(purityvec, weightvec);\n  surveydata$lyricprogZ[surveydata$id==x] <- weighted.mean(progvec, weightvec);\n  surveydata$lyricnegZ[surveydata$id==x] <- weighted.mean(negvec, weightvec);\n  surveydata$lyricposZ[surveydata$id==x] <- weighted.mean(posvec, weightvec);\n  surveydata$lyricreligZ[surveydata$id==x] <- weighted.mean(religvec, weightvec);\n  \n}\n\nsurveydata$genresfanned <- surveydata$Popfan+surveydata$Rockfan+surveydata$Christianfan+surveydata$Countryfan+surveydata$Rapfan+surveydata$Dancefan+surveydata$Rbfan+surveydata$Reggaefan+surveydata$Bluesfan+surveydata$Jazzfan;\n\nsurveydata2 <- subset(surveydata, genresfanned >= 1);\nsurveydata2$ideo5[surveydata2$ideo5==6] <- NA;\nsurveydata2$pid3[surveydata2$pid3>2] <- NA;\nsurveydata2$respondent_race_2[surveydata2$respondent_race_2==2] <- 0;\nsurveydata2$faminc[surveydata2$faminc>16] <- NA;\nsurveydata2$christianrelig <- 0;\nsurveydata2$christianrelig[surveydata2$religpew<5] <- 1;\nsurveydata2$age <- 2015-surveydata2$birthyr;\nsurveydata3 <- subset(surveydata2, is.na(ideo5)==FALSE);\n```\n\nNow we will do some analyses. First are some simple correlations, in this case between the lyric z-scores and the moral foundation questionnaire z-scores.\n```{r}\nsurveydata2$MFQ_HARM_Z <- scale(surveydata2$MFQ_HARM_AVG);\nsurveydata2$MFQ_FAIRNESS_Z <- scale(surveydata2$MFQ_FAIRNESS_AVG);\nsurveydata2$MFQ_INGROUP_Z <- scale(surveydata2$MFQ_INGROUP_AVG);\nsurveydata2$MFQ_AUTHORITY_Z <- scale(surveydata2$MFQ_AUTHORITY_AVG);\nsurveydata2$MFQ_PURITY_Z <- scale(surveydata2$MFQ_PURITY_AVG);\n\nrcorr(surveydata2$MFQ_HARM_Z, surveydata2$lyricharmZ);\nrcorr(surveydata2$MFQ_FAIRNESS_Z, surveydata2$lyricfairZ);\nrcorr(surveydata2$MFQ_INGROUP_Z, surveydata2$lyricingZ);\nrcorr(surveydata2$MFQ_AUTHORITY_Z, surveydata2$lyricauthZ);\nrcorr(surveydata2$MFQ_PURITY_Z, surveydata2$lyricpurityZ);\n```\n\nNo shock here, it's all about purity. \n\nNow we'll do a straightforward linear regression with the 5-point ideology scale as a DV. Those who responded that they don't know or otherwise refused to answer are recoded as missing. I don't include fairness here because it is least prevalent in the content analysis and including all five foundation z-score variables causes problems.\n\n```{r}\nfit <- lm(ideo5 ~ lyricharmZ + lyricfairZ + lyricingZ + lyricauthZ + lyricpurityZ, data = surveydata2);\nsummary(fit);\n```\nOnce again, purity is the standout and we have a nice enough overall adjusted R^2 of 0.13.\n\nWhat I thought would be interesting to do from here is to test whether the lyrical moral content offers *additional* predictive ability beyond some other relevant variables. Doing this in R works a little differently than SPSS, so what I do first is fit models for increasingly complex models. Then I run an ANOVA to see if each model is adding predictive ability over the previous ones.\n\n**Note: Changes were made Nov. 7th to the models below by adding more control variables to the first step.**\n\nFirst, I include a few control variables, including the black race variable as an initial step due to the potential that they could be major factors. It turns out that they seems not to be, though they aren't meaningless. The other controls are gender, age, and education.\n```{r}\nsurveydata2$age <- 2015-surveydata2$birthyr\n\nfit2 <- lm(ideo5 ~ respondent_race_2 + gender + age + educ, data=surveydata2);\nsummary(fit2);\n```\n\nNext, I add all MFT variables *from the questionnaire* to the model. There is a relationship established in the literature between MFT scores and ideology, so this should be significant.\n```{r}\nfit3 <- lm(ideo5 ~ respondent_race_2 + gender + age + educ + MFQ_PURITY_Z + MFQ_HARM_Z + MFQ_AUTHORITY_Z + MFQ_INGROUP_Z + MFQ_FAIRNESS_Z, data=surveydata2);\nsummary(fit3);\n```\nIt is. I think it is a tall task to ask the content analysis data to add additional prediction beyond the MFT scores, which already has a pretty high adjusted R^2.\n\nSo here is the moment of truth, you might say. I add the content analysis z-score variables to the model.\n```{r}\nfit4 <- lm(ideo5 ~ respondent_race_2 + gender + age + educ + lyricharmZ + lyricfairZ + lyricingZ + lyricauthZ + lyricpurityZ + MFQ_PURITY_Z + MFQ_HARM_Z + MFQ_AUTHORITY_Z + MFQ_INGROUP_Z + MFQ_FAIRNESS_Z, data=surveydata2);\nsummary(fit4);\n```\nOkay, it's a bit stronger model and the content analysis variables have significant coefficients. Is it going to be a significant F-change? We'll have to see in the ANOVA.\n\nLast but not least, I added the three identity-oriented variables from the survey about whether listening to favorite genres is a way to express/explore identities or show group membership.\n```{r}\nfit5 <- lm(ideo5 ~ respondent_race_2 + gender + age + educ + express_identity + membership + explore + lyricharmZ + lyricfairZ + lyricingZ + lyricauthZ + lyricpurityZ + MFQ_PURITY_Z + MFQ_HARM_Z + MFQ_AUTHORITY_Z + MFQ_INGROUP_Z + MFQ_FAIRNESS_Z, data=surveydata2);\nsummary(fit5);\n```\n\nNow, we will run the ANOVA to see if these more complicated models are adding anything useful.\n```{r}\nanova(fit2, fit3, fit4, fit5)\n```\n\nIndeed we are! Even with conceptually related and strongly predictive MFQ scores in the model, the content analysis variables are adding meaningfully to the model. The music--identity variables are on the borderline, particularly when we see they aren't individually significant in the model.\n\nFor ease of use, these operations print the R^2 change and associated F.\n```{r}\nlibrary(lmSupport);\n\nmodelCompare(fit2, fit3);\nmodelCompare(fit3, fit4)\n```\n\n# November 11th updates\n\nFirst, I'm going to re-do some of what I've done with the content data alone before, but with the raw frequency measures instead of the per MFT words measures. \n\n```{r}\nHarmTotSummary <- summarise(combined.grouped, TotHarmPer = mean(HarmTotal));\narrange(HarmTotSummary,desc(TotHarmPer),genre)\n```\n\n\n```{r}\nFairTotSummary <- summarise(combined.grouped, TotFairPer = mean(FairTotal));\narrange(FairTotSummary,desc(TotFairPer),genre);\n```\n\n\n```{r}\nAuthTotSummary <- summarise(combined.grouped, TotAuthPer = mean(AuthTotal));\narrange(AuthTotSummary,desc(TotAuthPer),genre);\n```\n\n\n```{r}\nIngTotSummary <- summarise(combined.grouped, TotIngPer = mean(IngTotal));\narrange(IngTotSummary,desc(TotIngPer),genre);\n```\n\n\n```{r}\nPurityTotSummary <- summarise(combined.grouped, TotPurityPer = mean(PurityTotal));\narrange(PurityTotSummary,desc(TotPurityPer),genre)\n```\n\nNow this is interesting in that country comes in quite a bit lower with this measure. Then again, it is low on nearly every measure because it just has fewer moral words than the other genres. This is more or less the reason I did the variable construction the other way (portion of MFT words) before; I'm not sure whether to attribute these rankings to X genre making this foundation more important than Y genre, or if it is simply that X genre talks more about morality *in general*. To me, it feels less interpretable given that it doesn't tell us about the within-genre prioritization. \n\nHere's another simplifying measure we can do. This takes the \"individualizing\" foundations--those important to liberals--and subtracts those from the \"binding\" foundations, those important to conservatives. I've seen MFT work do this before when the convenience of having a single variable was necessary (like when using as a DV in regression models).\n\n```{r}\nProgTotSummary <- summarise(combined.grouped, TotProgPer = mean(ProgressivismTotal));\narrange(ProgTotSummary,desc(TotProgPer),genre)\n```\n\nThe patterns here aren't 100% clear, if there are any. But there is a relatively strong relationship with the survey data...\n\n```{r}\nrcorr(surveydata2$MFQ_PROGRESSIVISM_AVG, surveydata2$lyricprogZ)\n```\n\nHere we can break it down on a lyric foundation by lyric foundation basis...\n\n```{r}\nfit <- lm(MFQ_PROGRESSIVISM_AVG ~ lyricharmZ + lyricfairZ + lyricingZ + lyricauthZ + lyricpurityZ, data=surveydata2);\nsummary(fit)\nmodelEffectSizes(fit)\n```\n\nThis is a little bit more of a mixed bag. Care/harm increases the progressivism measure, so it's good that it is associated with an increase in the self-report progressivism measure. Purity decreases the the progressivism measure, so it's good that it is associated with decreases in the self-report progressivism measure. \n\nLet's do the same hierarchical approach now.\n\n```{r}\nfit2 <- lm(MFQ_PROGRESSIVISM_AVG ~ educ + respondent_race_2 + gender + age + christianrelig, data=surveydata3)\nsummary(fit2)\n```\n\nNow let's add the ideology variable *as a predictor*. This, in my opinion, makes it a pretty tall order for lyric moral content to add additional predictive value after this.\n```{r}\nfit3 <- lm(MFQ_PROGRESSIVISM_AVG ~ educ + respondent_race_2 + gender + age + christianrelig + ideo5, data=surveydata3)\nsummary(fit3)\n```\n\nMoment of truth...\n```{r}\nfit4 <- lm(MFQ_PROGRESSIVISM_AVG ~ educ + respondent_race_2 + gender + age + christianrelig + ideo5 + lyricharmZ + lyricfairZ + lyricingZ + lyricauthZ + lyricpurityZ, data=surveydata3)\nsummary(fit4)\n```\n\nThat's encouraging! Let's check out the model improvement measures.\n\n```{r}\nanova(fit2, fit3, fit4);\nmodelCompare(fit2, fit3);\nmodelCompare(fit3, fit4);\n```\n\nThe following reports partial correlation squared (partial eta-sq., labeled as just eta-sq. in SPSS) as well as semipartial correlation squared (delta r-sq., SPSS just provides semipartial correlation)\n```{r}\nmodelEffectSizes(fit4)\n```\nIdeology is doing the heavy lifting here, but lyric purity has the third largest effect size in the model.\n\nSome diagnostics for the final model...\n\n```{r}\nlibrary(MASS)\nsresid <- studres(fit4) \nhist(sresid, freq=FALSE, \n     main=\"Distribution of Studentized Residuals\")\nxfit<-seq(min(sresid),max(sresid),length=40) \nyfit<-dnorm(xfit) \nlines(xfit, yfit)\n```\n\nLooks good.\n\n```{r}\n# VIF\nvif(fit4)\n```\n\nA couple of those are up there, but nothing unambiguously problematic.\n\n```{r}\n# Testing for autocorrelated errors\ndurbinWatsonTest(fit4)\n```\n\nGood.\n\n# Summary data\nJust as a note, I recoded some of the binary variables here so that the \"0\" response means \"no\", which was originally coded as 2. In the case of gender, 0 = female, meaning the sample is 46% male.\n```{r message=FALSE}\n# Harm\ncronbach(subset(surveydata2[c(\"suffered\",\"cared_weak\",\"protect_animals\",\"compassion\")]));\n# Fairness\ncronbach(subset(surveydata2[c(\"act_unfair\",\"treated_diff\",\"justice\",\"fair_treatment\")]));\n# Ingroup\ncronbach(subset(surveydata2[c(\"betrayal\",\"love_country\",\"proud_history\",\"family_loyalty\")]));\n# Authority\ncronbach(subset(surveydata2[c(\"conformed\",\"lack_respect\",\"gender_roles\",\"respect\")]));\n# Purity\ncronbach(subset(surveydata2[c(\"disgusting\",\"no_decency\",\"disgusting2\",\"unnatural\")]));\n\nlibrary(psych);\nrelvars2 <- c(\"age\", \"respondent_race_1\", \"respondent_race_2\", \"respondent_race_3\", \"respondent_race_4\", \"gender\", \"age\", \"educ\", \"pid3\", \"ideo5\", \"MFQ_HARM_AVG\", \"MFQ_FAIRNESS_AVG\", \"MFQ_INGROUP_AVG\", \"MFQ_AUTHORITY_AVG\", \"MFQ_PURITY_AVG\", \"MFQ_PROGRESSIVISM_AVG\", \"conservative\", \"liberal\", \"republican\", \"democrat\", \"Popfan\", \"Countryfan\", \"Christianfan\", \"Rockfan\", \"Rapfan\", \"Dancefan\", \"Rbfan\", \"Reggaefan\", \"Bluesfan\", \"Jazzfan\", \"genresfanned\");\nsummaryframe <- surveydata2[relvars2];\nsummaryframe$respondent_race_1[summaryframe$respondent_race_1==2] <- 0;\nsummaryframe$respondent_race_2[summaryframe$respondent_race_2==2] <- 0;\nsummaryframe$respondent_race_3[summaryframe$respondent_race_3==2] <- 0;\nsummaryframe$respondent_race_4[summaryframe$respondent_race_4==2] <- 0;\nsummaryframe$gender[summaryframe$gender==2] <- 0;\ndescribe(summaryframe)\n\n# Codes \"don't know much about it\" and skips to missing in the music measures.\ncondition <- surveydata2[,5:17] > 5;\nsurveydata2[,5:17][condition] <- NA;\ncondition <- surveydata2[,18:30] > 5;\nsurveydata2[,18:30][condition] <- NA;\n\nmean(surveydata2$like_Pop, na.rm = TRUE)\nmean(surveydata2$listen_Pop, na.rm = TRUE)\nlength(which(is.na(surveydata2$like_Pop)))/length(surveydata2)\n\nmean(surveydata2$like_Country, na.rm = TRUE)\nmean(surveydata2$listen_Country, na.rm = TRUE)\nlength(which(is.na(surveydata2$like_Country)))/length(surveydata2)\n\nmean(surveydata2$like_Rock, na.rm = TRUE)\nmean(surveydata2$listen_Rock, na.rm = TRUE)\nlength(which(is.na(surveydata2$like_Rock)))/length(surveydata2)\n\nmean(surveydata2$like_R_n_B, na.rm = TRUE)\nmean(surveydata2$listen_R_n_B, na.rm = TRUE)\nlength(which(is.na(surveydata2$like_R_n_B)))/length(surveydata2)\n\nmean(surveydata2$like_Rap, na.rm = TRUE)\nmean(surveydata2$listen_Rap, na.rm = TRUE)\nlength(which(is.na(surveydata2$like_Rap)))/length(surveydata2)\n\nmean(surveydata2$like_Dance, na.rm = TRUE)\nmean(surveydata2$listen_Dance, na.rm = TRUE)\nlength(which(is.na(surveydata2$like_Dance)))/length(surveydata2)\n\nmean(surveydata2$like_Latin, na.rm = TRUE)\nmean(surveydata2$listen_Latin, na.rm = TRUE)\nlength(which(is.na(surveydata2$like_Latin)))/length(surveydata2)\n\nmean(surveydata2$like_Christian, na.rm = TRUE)\nmean(surveydata2$listen_Christian, na.rm = TRUE)\nlength(which(is.na(surveydata2$like_Christian)))/length(surveydata2)\n\nmean(surveydata2$like_Blues, na.rm = TRUE)\nmean(surveydata2$listen_Blues, na.rm = TRUE)\nlength(which(is.na(surveydata2$like_Blues)))/length(surveydata2)\n\nmean(surveydata2$like_Classical, na.rm = TRUE)\nmean(surveydata2$listen_Classical, na.rm = TRUE)\nlength(which(is.na(surveydata2$like_Classical)))/length(surveydata2)\n\nmean(surveydata2$like_Jazz, na.rm = TRUE)\nmean(surveydata2$listen_Jazz, na.rm = TRUE)\nlength(which(is.na(surveydata2$like_Jazz)))/length(surveydata2)\n\nmean(surveydata2$like_New_Age, na.rm = TRUE)\nmean(surveydata2$listen_New_Age, na.rm = TRUE)\nlength(which(is.na(surveydata2$like_New_Age)))/length(surveydata2)\n\nmean(surveydata2$like_Reggae, na.rm = TRUE)\nmean(surveydata2$listen_Reggae, na.rm = TRUE)\nlength(which(is.na(surveydata2$like_Reggae)))/length(surveydata2)\n```\n\nAnd here for the music data. These are interpreted as percentages, so \"0.5\" would mean 0.5%, *not* 50%. \n```{r warning=FALSE}\nrelvars3 <- c(\"genre\", \"HarmTotal\", \"FairTotal\", \"AuthTotal\", \"IngTotal\", \"PurityTotal\");\ncasummaryframe <- combined[relvars3];\ndescribeBy(casummaryframe, group=casummaryframe$genre)\n```",
    "created" : 1456805358897.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2015960744",
    "id" : "E82F0254",
    "lastKnownWriteTime" : 1447822682,
    "last_content_update" : 1447822682,
    "path" : "~/BBSongDB/R analysis/rmarkdowndoc.Rmd",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}