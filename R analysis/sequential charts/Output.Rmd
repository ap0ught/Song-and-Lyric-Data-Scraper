---
title: "Lyrics over time"
author: "Jacob Long"
date: "February 28, 2016"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```
```{r include=FALSE}
library(car)
library(reshape)
surveydata <- read.csv("~/BBSongDB/R analysis/TOSU0011_OUTPUT.csv")
test3 <- read.csv("test3.csv")

test3$purity <- test3$PurityVice + test3$PurityVirtue
test3$authority <- test3$AuthorityVice + test3$AuthorityVirtue
test3$ingroup <- test3$IngroupVice + test3$IngroupVirtue
test3$fairness <- test3$FairnessVice + test3$FairnessVirtue
test3$harm <- test3$HarmVice + test3$HarmVirtue
test3$totmoral <- test3$purity + test3$authority + test3$ingroup + test3$fairness + test3$harm
test3$purityper <- test3$purity/test3$totmoral
test3$authorityper <- test3$authority/test3$totmoral
test3$ingroupper <- test3$ingroup/test3$totmoral
test3$fairnessper <- test3$fairness/test3$totmoral
test3$harmper <- test3$harm/test3$totmoral

library(psych)
library(Hmisc)
library(ggplot2)

# Getting rid of some extraneous variables
test4 <- subset(test3, select=c(genre,year,politic,HarmVice,HarmVirtue,FairnessVice,FairnessVirtue,IngroupVice,IngroupVirtue,AuthorityVice,AuthorityVirtue,PurityVice,PurityVirtue))
summary <- aggregate(test4, data=test4, by=list(genre1=test4$genre,year1=test4$year), FUN = "mean", na.rm=TRUE)
# Combining MFT vice/virtue
summary$purity <- summary$PurityVice + summary$PurityVirtue
summary$authority <- summary$AuthorityVice + summary$AuthorityVirtue
summary$ingroup <- summary$IngroupVice + summary$IngroupVirtue
summary$fairness <- summary$FairnessVice + summary$FairnessVirtue
summary$harm <- summary$HarmVice + summary$HarmVirtue
summary$totmoral <- summary$purity + summary$authority + summary$ingroup + summary$fairness + summary$harm
summary$purityper <- summary$purity/summary$totmoral
summary$authorityper <- summary$authority/summary$totmoral
summary$ingroupper <- summary$ingroup/summary$totmoral
summary$fairnessper <- summary$fairness/summary$totmoral
summary$harmper <- summary$harm/summary$totmoral
# Getting rid of the holdover vice/virtue variables
ridofme <- names(summary) %in% c("year", "genre","PurityVice","PurityVirtue","AuthorityVice","AuthorityVirtue","IngroupVice","IngroupVirtue","FairnessVice","FairnessVirtue","HarmVice","HarmVirtue")
summary1 <- summary[!ridofme]

summary1 <- transform(summary1, purity.rank = ave(purity, year1, FUN = function(x) rank(-x, ties.method = "first")))
summary1 <- transform(summary1, authority.rank = ave(authority, year1, FUN = function(x) rank(-x, ties.method = "first")))
summary1 <- transform(summary1, ingroup.rank = ave(ingroup, year1, FUN = function(x) rank(-x, ties.method = "first")))
summary1 <- transform(summary1, fairness.rank = ave(fairness, year1, FUN = function(x) rank(-x, ties.method = "first")))
summary1 <- transform(summary1, harm.rank = ave(harm, year1, FUN = function(x) rank(-x, ties.method = "first")))
summary1 <- transform(summary1, politic.rank = ave(politic, year1, FUN = function(x) rank(-x, ties.method = "first")))

summary1 <- transform(summary1, purityper.rank = ave(purityper, year1, FUN = function(x) rank(-x, ties.method = "first")))
summary1 <- transform(summary1, authorityper.rank = ave(authorityper, year1, FUN = function(x) rank(-x, ties.method = "first")))
summary1 <- transform(summary1, ingroupper.rank = ave(ingroupper, year1, FUN = function(x) rank(-x, ties.method = "first")))
summary1 <- transform(summary1, fairnessper.rank = ave(fairnessper, year1, FUN = function(x) rank(-x, ties.method = "first")))
summary1 <- transform(summary1, harmper.rank = ave(harmper, year1, FUN = function(x) rank(-x, ties.method = "first")))

summary2 <- subset(summary1[names(summary1) %in% c("genre1", "year1", "harm.rank","purity.rank","authority.rank","ingroup.rank","fairness.rank","politic.rank")],summary1$year1>1999)

library(dplyr)
library(tidyr)

summary3 <- subset(summary1[names(summary1) %in% c("genre1", "year1", "harm.rank","purity.rank","authority.rank","ingroup.rank","fairness.rank","politic.rank")], summary1$year>2009)
summary4 <- subset(summary1[names(summary1) %in% c("genre1", "year1", "harm.rank","purity.rank","authority.rank","ingroup.rank","fairness.rank", "politic.rank", "politic")], summary1$year>2009)

summary3.grouped <- group_by(summary3, genre1) 
summary2.grouped <- group_by(summary2, genre1) 

#survey data stuff

condition <- surveydata[,44:65] > 6;
surveydata[,44:65][condition] <- NA;
sixtofive <- function(x){
  x <- (4/5)*x - (1/5);
return(x); }
surveydata[,44:54] <- sixtofive(surveydata[,44:54])
surveydata$age <- 2015-surveydata$birthyr

surveydata$MFQ_HARM_AVG = (surveydata$suffered+surveydata$cared_weak+surveydata$protect_animals+surveydata$compassion)/4;
surveydata$MFQ_FAIRNESS_AVG = (surveydata$act_unfair+surveydata$treated_diff+surveydata$justice+surveydata$fair_treatment)/4;
surveydata$MFQ_INGROUP_AVG = (surveydata$betrayal+surveydata$love_country+surveydata$proud_history+surveydata$family_loyalty)/4;
surveydata$MFQ_AUTHORITY_AVG = (surveydata$conformed+surveydata$lack_respect+surveydata$gender_roles+surveydata$respect)/4;
surveydata$MFQ_PURITY_AVG = (surveydata$disgusting+surveydata$no_decency+surveydata$disgusting2+surveydata$unnatural)/4;
surveydata$MFQ_PROGRESSIVISM_AVG = ((surveydata$MFQ_HARM_AVG+surveydata$MFQ_FAIRNESS_AVG)/2)-((surveydata$MFQ_INGROUP_AVG+surveydata$MFQ_AUTHORITY_AVG+surveydata$MFQ_PURITY_AVG)/3);

surveydata <- subset(surveydata, is.na(MFQ_HARM_AVG)==FALSE);
surveydata <- subset(surveydata, is.na(MFQ_PROGRESSIVISM_AVG)==FALSE);

# Now I'm adding binary variables for conservative and liberal
surveydata$conservative[surveydata$ideo5==4] <- 1;
surveydata$conservative[surveydata$ideo5==5] <- 1;
surveydata$conservative[surveydata$ideo5==6] <- 0;
surveydata$conservative[surveydata$ideo5<4] <- 0;
surveydata$liberal[surveydata$ideo5<3] <- 1;
surveydata$liberal[surveydata$ideo5>2] <- 0;
surveydata$democrat[surveydata$pid3==1] <- 1;
surveydata$democrat[surveydata$pid3>1] <- 0;
surveydata$republican[surveydata$pid3==2] <- 1;
surveydata$republican[surveydata$pid3!=2] <- 0;

# Creating separate data frames for each type of fan to look at their specific characteristics
Popfans = subset(surveydata, (surveydata$like_Pop==4 | surveydata$like_Pop==5) & (surveydata$listen_Pop >= 3 & surveydata$listen_Pop < 6));
Countryfans = subset(surveydata, (surveydata$like_Country==4 | surveydata$like_Country==5) & (surveydata$listen_Country >= 3 & surveydata$listen_Country < 6));
Christianfans = subset(surveydata, (surveydata$like_Christian==4 | surveydata$like_Christian==5) & (surveydata$listen_Christian >= 3 & surveydata$listen_Christian < 6));
Rockfans = subset(surveydata, (surveydata$like_Rock==4 | surveydata$like_Rock==5) & (surveydata$listen_Rock >= 3 & surveydata$listen_Rock < 6));
Rapfans = subset(surveydata, (surveydata$like_Rap==4 | surveydata$like_Rap==5) & (surveydata$listen_Rap >= 3 & surveydata$listen_Rap < 6));
Dancefans = subset(surveydata, (surveydata$like_Dance==4 | surveydata$like_Dance==5) & (surveydata$listen_Dance >= 3 & surveydata$listen_Dance < 6));
Rbfans = subset(surveydata, (surveydata$like_R_n_B==4 | surveydata$like_R_n_B==5) & (surveydata$listen_R_n_B >= 3 & surveydata$listen_R_n_B < 6));
Reggaefans = subset(surveydata, (surveydata$like_Reggae ==4 | surveydata$like_Reggae == 5) & (surveydata$listen_Reggae >= 3 & surveydata$listen_Reggae < 6));
Bluesfans = subset(surveydata, (surveydata$like_Blues ==4 | surveydata$like_Blues == 5) & (surveydata$listen_Blues >= 3 & surveydata$listen_Blues < 6));
Jazzfans = subset(surveydata, (surveydata$like_Jazz ==4 | surveydata$like_Jazz == 5) & (surveydata$listen_Jazz >= 3 & surveydata$listen_Jazz < 6));

# Creating a binary variable for each respondent where 1 is fan of a genre and 0 is not fan.
surveydata$Popfan[surveydata$like_Pop==4 | surveydata$like_Pop==5] <- 1; 
surveydata$Popfan[surveydata$like_Pop !=4 & surveydata$like_Pop !=5] <- 0;
surveydata$Countryfan[surveydata$like_Country==4 | surveydata$like_Country==5] <- 1; 
surveydata$Countryfan[surveydata$like_Country !=4 & surveydata$like_Country !=5] <- 0;
surveydata$Christianfan[surveydata$like_Christian==4 | surveydata$like_Christian==5] <- 1; 
surveydata$Christianfan[surveydata$like_Christian !=4 & surveydata$like_Christian !=5] <- 0;
surveydata$Rockfan[surveydata$like_Rock==4 | surveydata$like_Rock==5] <- 1; 
surveydata$Rockfan[surveydata$like_Rock !=4 & surveydata$like_Rock !=5] <- 0;
surveydata$Rapfan[surveydata$like_Rap==4 | surveydata$like_Rap==5] <- 1; 
surveydata$Rapfan[surveydata$like_Rap !=4 & surveydata$like_Rap !=5] <- 0;
surveydata$Dancefan[surveydata$like_Dance==4 | surveydata$like_Dance==5] <- 1; 
surveydata$Dancefan[surveydata$like_Dance !=4 & surveydata$like_Dance !=5] <- 0;
surveydata$Rbfan[surveydata$like_R_n_B==4 | surveydata$like_R_n_B==5] <- 1; 
surveydata$Rbfan[surveydata$like_R_n_B !=4 & surveydata$like_R_n_B !=5] <- 0;
surveydata$Reggaefan[surveydata$like_Reggae==4 | surveydata$like_Reggae==5] <- 1; 
surveydata$Reggaefan[surveydata$like_Reggae !=4 & surveydata$like_Reggae !=5] <- 0;
surveydata$Bluesfan[surveydata$like_Blues==4 | surveydata$like_Blues==5] <- 1; 
surveydata$Bluesfan[surveydata$like_Blues !=4 & surveydata$like_Blues !=5] <- 0;
surveydata$Jazzfan[surveydata$like_Jazz==4 | surveydata$like_Jazz==5] <- 1; 
surveydata$Jazzfan[surveydata$like_Jazz !=4 & surveydata$like_Jazz !=5] <- 0;
surveydata$genresliked <- surveydata$Popfan+surveydata$Rockfan+surveydata$Christianfan+surveydata$Countryfan+surveydata$Rapfan+surveydata$Dancefan+surveydata$Rbfan+surveydata$Reggaefan+surveydata$Bluesfan+surveydata$Jazzfan;

# I'm going to recode some variables as missing, so I first will create a duplicate survey dataset
surveydata2 <- surveydata;
# Now I'm going to recode don't know/other answers in the ideo5 and pid3 variables as missing for the sake of presenting things clearly
surveydata2$ideo5[surveydata2$ideo5==6] <- NA;
surveydata2$pid3[surveydata2$pid3>2] <- NA;

surveydata3 <- subset(surveydata2, is.na(ideo5)==FALSE)

# Going to add a genre variable to each subset so I can then combine them into a single dataframe for ease of analysis
Popfans$genre = "pop";Countryfans$genre = "country";Christianfans$genre = "christian";Rockfans$genre = "rock";
Rapfans$genre = "rap";Rbfans$genre = "rbhiphop";Dancefans$genre = "dance";Reggaefans$genre = "reggae";
Bluesfans$genre = "blues";Jazzfans$genre = "jazz";
# Now I combine them into one dataset
allfans <- rbind(Popfans,Countryfans,Christianfans,Rockfans,Rapfans,Rbfans,Dancefans,Reggaefans,Bluesfans,Jazzfans);
# Now, much like with the lyrics data, I make another table containing the MFT means for each genre's fans
fangenremeans <- aggregate(allfans, data=allfans, by=list(genre=allfans$genre), FUN="mean");

# First a brief exploration of the moral differences of each genre's fans
fangenremeansmelt <- melt(fangenremeans[c("genre", "MFQ_HARM_AVG", "MFQ_FAIRNESS_AVG", "MFQ_INGROUP_AVG", "MFQ_AUTHORITY_AVG", "MFQ_PURITY_AVG")]);

### CA from original analyses
blues <- read.delim("~/BBSongDB/lyrics2/blues/blues100results.dat");
christian <- read.delim("~/BBSongDB/lyrics2/christian/christian100results.dat");
country <- read.delim("~/BBSongDB/lyrics2/country/country100results.dat");
dance <- read.delim("~/BBSongDB/lyrics2/danceelectronic/danceelectronic100results.dat");
jazz <- read.delim("~/BBSongDB/lyrics2/jazz/jazz100results.dat");
pop <- read.delim("~/BBSongDB/lyrics2/pop/pop100results.dat");
rbhiphop <- read.delim("~/BBSongDB/lyrics2/R&Bhip hop/rbhiphop100results.dat");
rap <- read.delim("~/BBSongDB/lyrics2/rap/rap100results.dat");
reggae <- read.delim("~/BBSongDB/lyrics2/reggae/reggae100results.dat");
rock <- read.delim("~/BBSongDB/lyrics2/rock/rock100results.dat");

blues$genre <- "blues"; christian$genre <- "christian"; country$genre <- "country"; dance$genre <- "dance"; jazz$genre <- "jazz"; pop$genre <- "pop"; rbhiphop$genre <- "rbhiphop"; rap$genre <- "rap"; reggae$genre <- "reggae"; rock$genre <- "rock";

combined <- rbind(blues,christian,country,dance,jazz,pop,rbhiphop,rap,reggae,rock);
combined$HarmTotal <- combined$HarmVirtue + combined$HarmVice;
combined$FairTotal <- combined$FairnessVirtue + combined$FairnessVice;
combined$IngTotal <- combined$IngroupVirtue + combined$IngroupVice;
combined$AuthTotal <- combined$AuthorityVirtue + combined$AuthorityVice;
combined$PurityTotal <- combined$PurityVirtue + combined$PurityVice;

combined$ProgressivismTotal <- ((combined$HarmTotal + combined$FairTotal)/2) - ((combined$IngTotal + combined$AuthTotal + combined$PurityTotal)/3);
combined$ProgVice <- (combined$HarmVice + combined$FairnessVice) - (combined$IngroupVice + combined$AuthorityVice + combined$PurityVice);
combined$ProgVirtue <- (combined$HarmVirtue + combined$FairnessVirtue) - (combined$IngroupVirtue + combined$AuthorityVirtue + combined$PurityVirtue);
combined$TotalMFT <- combined$HarmTotal + combined$AuthTotal + combined$IngTotal + combined$PurityTotal + combined$FairTotal;
combined$TotalMoral <- combined$TotalMFT + combined$MoralityGeneral;

blues <- subset(combined, genre=='blues');
christian <- subset(combined, genre=='christian');
country <- subset(combined, genre=='country');
dance <- subset(combined, genre=='dance');
jazz <- subset(combined, genre=='jazz');
pop <- subset(combined, genre=='pop');
rap <- subset(combined, genre=='rap');
rbhiphop <- subset(combined, genre=='rbhiphop');
reggae <- subset(combined, genre=='reggae');
rock <- subset(combined, genre=='rock');

irrelvars <- names(combined) %in% c("Filename", "Segment", "WC");
combined <- combined[!irrelvars];

genremeans <- aggregate(combined, by=list(genre = combined$genre), FUN = "mean");

genremeans$HarmTotPer = (genremeans$HarmTotal/genremeans$TotalMFT);
genremeans$AuthTotPer = (genremeans$AuthTotal/genremeans$TotalMFT);
genremeans$IngTotPer = (genremeans$IngTotal/genremeans$TotalMFT);
genremeans$FairTotPer = (genremeans$FairTotal/genremeans$TotalMFT);
genremeans$PurityTotPer = (genremeans$PurityTotal/genremeans$TotalMFT);
genremeans$ProgTotPer = (((genremeans$HarmTotal + genremeans$FairTotal)-(genremeans$IngTotPer+genremeans$FairTotPer+genremeans$PurityTotPer))/genremeans$TotalMFT);

genremeans$HarmTotPer2 = (genremeans$HarmTotal/genremeans$TotalMoral);
genremeans$AuthTotPer2 = (genremeans$AuthTotal/genremeans$TotalMoral);
genremeans$IngTotPer2 = (genremeans$IngTotal/genremeans$TotalMoral);
genremeans$FairTotPer2 = (genremeans$FairTotal/genremeans$TotalMoral);
genremeans$PurityTotPer2 = (genremeans$PurityTotal/genremeans$TotalMoral);
genremeans$MoralGenPer2 <- 1-(genremeans$HarmTotPer2 + genremeans$FairTotPer2+genremeans$AuthTotPer2+genremeans$IngTotPer2+genremeans$PurityTotPer2);

genremeans$HarmZ <- scale(genremeans$HarmTotPer);
genremeans$FairZ <- scale(genremeans$FairTotPer);
genremeans$AuthZ <- scale(genremeans$AuthTotPer);
genremeans$IngZ <- scale(genremeans$IngTotPer);
genremeans$PurityZ <- scale(genremeans$PurityTotPer);

genremeans$HarmZ2 <- scale(genremeans$HarmTotal);
genremeans$FairZ2 <- scale(genremeans$FairTotal);
genremeans$AuthZ2 <- scale(genremeans$AuthTotal);
genremeans$IngZ2 <- scale(genremeans$IngTotal);
genremeans$PurityZ2 <- scale(genremeans$PurityTotal);

genremeans$MoralGenZ2 <- scale(genremeans$MoralityGeneral);

joinedmeans <- cbind(fangenremeans, genremeans);

bluespmean <- mean(summary4$politic[summary4$genre=="blues"])
joinedmeans$politic[joinedmeans$genre=="blues"] <- bluespmean
joinedmeans$politicZ[joinedmeans$genre=="blues"] <- scale(summary4$politic[summary4$genre=="blues"])
christianpmean <- mean(summary4$politic[summary4$genre=="christian"])
joinedmeans$politicZ[joinedmeans$genre=="christian"] <- scale(summary4$politic[summary4$genre=="christian"])
joinedmeans$politic[joinedmeans$genre=="christian"] <- christianpmean
countrypmean <- mean(summary4$politic[summary4$genre=="country"])
joinedmeans$politic[joinedmeans$genre=="country"] <- countrypmean
joinedmeans$politicZ[joinedmeans$genre=="country"] <- scale(summary4$politic[summary4$genre=="country"])
dancepmean <- mean(summary4$politic[summary4$genre=="dance"])
joinedmeans$politic[joinedmeans$genre=="dance"] <- dancepmean
joinedmeans$politicZ[joinedmeans$genre=="dance"] <- scale(summary4$politic[summary4$genre=="dance"])
jazzpmean <- mean(summary4$politic[summary4$genre=="jazz"])
joinedmeans$politic[joinedmeans$genre=="jazz"] <- jazzpmean
joinedmeans$politicZ[joinedmeans$genre=="jazz"] <- scale(summary4$politic[summary4$genre=="jazz"])
poppmean <- mean(summary4$politic[summary4$genre=="pop"])
joinedmeans$politic[joinedmeans$genre=="pop"] <- poppmean
joinedmeans$politicZ[joinedmeans$genre=="pop"] <- scale(summary4$politic[summary4$genre=="pop"])
reggaepmean <- mean(summary4$politic[summary4$genre=="reggae"])
joinedmeans$politic[joinedmeans$genre=="reggae"] <- reggaepmean
joinedmeans$politicZ[joinedmeans$genre=="reggae"] <- scale(summary4$politic[summary4$genre=="reggae"])
rbhiphoppmean <- mean(summary4$politic[summary4$genre=="rbhiphop"])
joinedmeans$politic[joinedmeans$genre=="rbhiphop"] <- rbhiphoppmean
joinedmeans$politicZ[joinedmeans$genre=="rbhiphop"] <- scale(summary4$politic[summary4$genre=="rbhiphop"])
rappmean <- mean(summary4$politic[summary4$genre=="rap"])
joinedmeans$politic[joinedmeans$genre=="rap"] <- rappmean
joinedmeans$politicZ[joinedmeans$genre=="rap"] <- scale(summary4$politic[summary4$genre=="rap"])
rockpmean <- mean(summary4$politic[summary4$genre=="rock"])
joinedmeans$politic[joinedmeans$genre=="rock"] <- rockpmean
joinedmeans$politicZ[joinedmeans$genre=="rock"] <- scale(summary4$politic[summary4$genre=="rock"])

surveydata$id <- row.names(surveydata);

rows <- c(surveydata$id)
for (x in rows) {
  
  harmvec <- c();
  fairvec <- c();
  ingvec <- c();
  authvec <- c();
  purityvec <- c();
  progvec <- c();
  negvec <- c();
  posvec <- c();
  religvec <- c();
  polvec <- c();
  
  weightvec <- c();
  
  if (surveydata$like_Pop[surveydata$id==x] > 3 & surveydata$like_Pop[surveydata$id==x] < 6) {
    harmvec <- c(harmvec, genremeans$HarmZ2[genremeans$genre=="pop"]);
    fairvec <- c(fairvec, genremeans$FairZ2[genremeans$genre=="pop"]);
    ingvec <- c(ingvec, genremeans$IngZ2[genremeans$genre=="pop"]);
    authvec <- c(authvec, genremeans$AuthZ2[genremeans$genre=="pop"]);
    purityvec <- c(purityvec, genremeans$PurityZ2[genremeans$genre=="pop"]);
    negvec <- c(negvec, genremeans$negemo[genremeans$genre=="pop"]);
    posvec <- c(posvec, genremeans$posemo[genremeans$genre=="pop"]);
    religvec <- c(religvec, genremeans$relig[genremeans$genre=="pop"]);
    progvec <- c(progvec, genremeans$ProgressivismTotal[genremeans$genre=="pop"]);
    polvec <- c(polvec, joinedmeans$politicZ[joinedmeans$genre=="pop"]);
    
    if (surveydata$listen_Pop[surveydata$id==x] == 3) weightvec <- c(weightvec, 1);
    if (surveydata$listen_Pop[surveydata$id==x] == 4) weightvec <- c(weightvec, 2);
    if (surveydata$listen_Pop[surveydata$id==x] == 5) weightvec <- c(weightvec, 4);
    if (surveydata$listen_Pop[surveydata$id==x] < 3 | surveydata$listen_Pop[surveydata$id==x] > 5) weightvec <- c(weightvec, 0);
    
    if (surveydata$listen_Pop[surveydata$id==x] < 3 | surveydata$listen_Pop[surveydata$id==x] > 5) surveydata$Popfan[surveydata$id==x] <- 0
    else surveydata$Popfan[surveydata$id==x] <- 1;
    
  };
  
  if (surveydata$like_Country[surveydata$id==x] > 3 & surveydata$like_Country[surveydata$id==x] < 6) {
    harmvec <- c(harmvec, genremeans$HarmZ2[genremeans$genre=="country"]);
    fairvec <- c(fairvec, genremeans$FairZ2[genremeans$genre=="country"]);
    ingvec <- c(ingvec, genremeans$IngZ2[genremeans$genre=="country"]);
    authvec <- c(authvec, genremeans$AuthZ2[genremeans$genre=="country"]);
    purityvec <- c(purityvec, genremeans$PurityZ2[genremeans$genre=="country"]);
    negvec <- c(negvec, genremeans$negemo[genremeans$genre=="country"]);
    posvec <- c(posvec, genremeans$posemo[genremeans$genre=="country"]);
    religvec <- c(religvec, genremeans$relig[genremeans$genre=="country"]);
    progvec <- c(progvec, genremeans$ProgressivismTotal[genremeans$genre=="country"]);
    polvec <- c(polvec, joinedmeans$politicZ[joinedmeans$genre=="country"]);
    
    if (surveydata$listen_Country[surveydata$id==x] == 3) weightvec <- c(weightvec, 1);
    if (surveydata$listen_Country[surveydata$id==x] == 4) weightvec <- c(weightvec, 2);
    if (surveydata$listen_Country[surveydata$id==x] == 5) weightvec <- c(weightvec, 4);
    if (surveydata$listen_Country[surveydata$id==x] < 3 | surveydata$listen_Country[surveydata$id==x] > 5) weightvec <- c(weightvec, 0);
    
    if (surveydata$listen_Country[surveydata$id==x] < 3 | surveydata$listen_Country[surveydata$id==x] > 5) surveydata$Countryfan[surveydata$id==x] <- 0
    else surveydata$Countryfan[surveydata$id==x] <- 1;
  };
  
  if (surveydata$like_Rock[surveydata$id==x] > 3 & surveydata$like_Rock[surveydata$id==x] < 6) {
    harmvec <- c(harmvec, genremeans$HarmZ2[genremeans$genre=="rock"]);
    fairvec <- c(fairvec, genremeans$FairZ2[genremeans$genre=="rock"]);
    ingvec <- c(ingvec, genremeans$IngZ2[genremeans$genre=="rock"]);
    authvec <- c(authvec, genremeans$AuthZ2[genremeans$genre=="rock"]);
    purityvec <- c(purityvec, genremeans$PurityZ2[genremeans$genre=="rock"]);
    negvec <- c(negvec, genremeans$negemo[genremeans$genre=="rock"]);
    posvec <- c(posvec, genremeans$posemo[genremeans$genre=="rock"]);
    religvec <- c(religvec, genremeans$relig[genremeans$genre=="rock"]);
    progvec <- c(progvec, genremeans$ProgressivismTotal[genremeans$genre=="rock"]);
    polvec <- c(polvec, joinedmeans$politicZ[joinedmeans$genre=="rock"]);
    
    if (surveydata$listen_Rock[surveydata$id==x] == 3) weightvec <- c(weightvec, 1);
    if (surveydata$listen_Rock[surveydata$id==x] == 4) weightvec <- c(weightvec, 2);
    if (surveydata$listen_Rock[surveydata$id==x] == 5) weightvec <- c(weightvec, 4);
    if (surveydata$listen_Rock[surveydata$id==x] < 3 | surveydata$listen_Rock[surveydata$id==x] > 5) weightvec <- c(weightvec, 0);
    if (surveydata$listen_Rock[surveydata$id==x] < 3 | surveydata$listen_Rock[surveydata$id==x] > 5) surveydata$Rockfan[surveydata$id==x] <- 0
    else surveydata$Rockfan[surveydata$id==x] <- 1;
  };
  
  
  if (surveydata$like_R_n_B[surveydata$id==x] > 3 & surveydata$like_R_n_B[surveydata$id==x] < 6) {
    harmvec <- c(harmvec, genremeans$HarmZ2[genremeans$genre=="rbhiphop"]);
    fairvec <- c(fairvec, genremeans$FairZ2[genremeans$genre=="rbhiphop"]);
    ingvec <- c(ingvec, genremeans$IngZ2[genremeans$genre=="rbhiphop"]);
    authvec <- c(authvec, genremeans$AuthZ2[genremeans$genre=="rbhiphop"]);
    purityvec <- c(purityvec, genremeans$PurityZ2[genremeans$genre=="rbhiphop"]);
    negvec <- c(negvec, genremeans$negemo[genremeans$genre=="rbhiphop"]);
    posvec <- c(posvec, genremeans$posemo[genremeans$genre=="rbhiphop"]);
    religvec <- c(religvec, genremeans$relig[genremeans$genre=="rbhiphop"]);
    progvec <- c(progvec, genremeans$ProgressivismTotal[genremeans$genre=="rbhiphop"]);
    polvec <- c(polvec, joinedmeans$politicZ[joinedmeans$genre=="rbhiphop"]);
    
    if (surveydata$listen_R_n_B[surveydata$id==x] == 3) weightvec <- c(weightvec, 1);
    if (surveydata$listen_R_n_B[surveydata$id==x] == 4) weightvec <- c(weightvec, 2);
    if (surveydata$listen_R_n_B[surveydata$id==x] == 5) weightvec <- c(weightvec, 4);
    if (surveydata$listen_R_n_B[surveydata$id==x] < 3 | surveydata$listen_R_n_B[surveydata$id==x] > 5) weightvec <- c(weightvec, 0);
    if (surveydata$listen_R_n_B[surveydata$id==x] < 3 | surveydata$listen_R_n_B[surveydata$id==x] > 5) surveydata$Rbfan[surveydata$id==x] <- 0
    else surveydata$Rbfan[surveydata$id==x] <- 1;
  };
  
  if (surveydata$like_Rap[surveydata$id==x] > 3 & surveydata$like_Rap[surveydata$id==x] < 6) {
    harmvec <- c(harmvec, genremeans$HarmZ2[genremeans$genre=="rap"]);
    fairvec <- c(fairvec, genremeans$FairZ2[genremeans$genre=="rap"]);
    ingvec <- c(ingvec, genremeans$IngZ2[genremeans$genre=="rap"]);
    authvec <- c(authvec, genremeans$AuthZ2[genremeans$genre=="rap"]);
    purityvec <- c(purityvec, genremeans$PurityZ2[genremeans$genre=="rap"]);
    negvec <- c(negvec, genremeans$negemo[genremeans$genre=="rap"]);
    posvec <- c(posvec, genremeans$posemo[genremeans$genre=="rap"]);
    religvec <- c(religvec, genremeans$relig[genremeans$genre=="rap"]);
    progvec <- c(progvec, genremeans$ProgressivismTotal[genremeans$genre=="rap"]);
    polvec <- c(polvec, joinedmeans$politicZ[joinedmeans$genre=="rap"]);
    
    if (surveydata$listen_Rap[surveydata$id==x] == 3) weightvec <- c(weightvec, 1);
    if (surveydata$listen_Rap[surveydata$id==x] == 4) weightvec <- c(weightvec, 2);
    if (surveydata$listen_Rap[surveydata$id==x] == 5) weightvec <- c(weightvec, 4);
    if (surveydata$listen_Rap[surveydata$id==x] < 3 | surveydata$listen_Rap[surveydata$id==x] > 5) weightvec <- c(weightvec, 0);
    if (surveydata$listen_Rap[surveydata$id==x] < 3 | surveydata$listen_Rap[surveydata$id==x] > 5) surveydata$Rapfan[surveydata$id==x] <- 0
    else surveydata$Rapfan[surveydata$id==x] <- 1;
  };
  
  if (surveydata$like_Dance[surveydata$id==x] > 3 & surveydata$like_Dance[surveydata$id==x] < 6) {
    harmvec <- c(harmvec, genremeans$HarmZ2[genremeans$genre=="dance"]);
    fairvec <- c(fairvec, genremeans$FairZ2[genremeans$genre=="dance"]);
    ingvec <- c(ingvec, genremeans$IngZ2[genremeans$genre=="dance"]);
    authvec <- c(authvec, genremeans$AuthZ2[genremeans$genre=="dance"]);
    purityvec <- c(purityvec, genremeans$PurityZ2[genremeans$genre=="dance"]);
    negvec <- c(negvec, genremeans$negemo[genremeans$genre=="dance"]);
    posvec <- c(posvec, genremeans$posemo[genremeans$genre=="dance"]);
    religvec <- c(religvec, genremeans$relig[genremeans$genre=="dance"]);
    progvec <- c(progvec, genremeans$ProgressivismTotal[genremeans$genre=="dance"]);
    polvec <- c(polvec, joinedmeans$politicZ[joinedmeans$genre=="dance"]);
    
    if (surveydata$listen_Dance[surveydata$id==x] == 3) weightvec <- c(weightvec, 1);
    if (surveydata$listen_Dance[surveydata$id==x] == 4) weightvec <- c(weightvec, 2);
    if (surveydata$listen_Dance[surveydata$id==x] == 5) weightvec <- c(weightvec, 4);
    if (surveydata$listen_Dance[surveydata$id==x] < 3 | surveydata$listen_Dance[surveydata$id==x] > 5) weightvec <- c(weightvec, 0);
    if (surveydata$listen_Dance[surveydata$id==x] < 3 | surveydata$listen_Dance[surveydata$id==x] > 5) surveydata$Dancefan[surveydata$id==x] <- 0
    else surveydata$Dancefan[surveydata$id==x] <- 1;
  };
  
  if (surveydata$like_Christian[surveydata$id==x] > 3 & surveydata$like_Christian[surveydata$id==x] < 6) {
    harmvec <- c(harmvec, genremeans$HarmZ2[genremeans$genre=="christian"]);
    fairvec <- c(fairvec, genremeans$FairZ2[genremeans$genre=="christian"]);
    ingvec <- c(ingvec, genremeans$IngZ2[genremeans$genre=="christian"]);
    authvec <- c(authvec, genremeans$AuthZ2[genremeans$genre=="christian"]);
    purityvec <- c(purityvec, genremeans$PurityZ2[genremeans$genre=="christian"]);
    negvec <- c(negvec, genremeans$negemo[genremeans$genre=="christian"]);
    posvec <- c(posvec, genremeans$posemo[genremeans$genre=="christian"]);
    religvec <- c(religvec, genremeans$relig[genremeans$genre=="christian"]);
    progvec <- c(progvec, genremeans$ProgressivismTotal[genremeans$genre=="christian"]);
    polvec <- c(polvec, joinedmeans$politicZ[joinedmeans$genre=="christian"]);
    
    if (surveydata$listen_Christian[surveydata$id==x] == 3) weightvec <- c(weightvec, 1);
    if (surveydata$listen_Christian[surveydata$id==x] == 4) weightvec <- c(weightvec, 2);
    if (surveydata$listen_Christian[surveydata$id==x] == 5) weightvec <- c(weightvec, 4);
    if (surveydata$listen_Christian[surveydata$id==x] < 3 | surveydata$listen_Christian[surveydata$id==x] > 5) weightvec <- c(weightvec, 0);
    if (surveydata$listen_Christian[surveydata$id==x] < 3 | surveydata$listen_Christian[surveydata$id==x] > 5) surveydata$Christianfan[surveydata$id==x] <- 0
    else surveydata$Christianfan[surveydata$id==x] <- 1;
  };
  
  if (surveydata$like_Jazz[surveydata$id==x] > 3 & surveydata$like_Jazz[surveydata$id==x] < 6) {
    harmvec <- c(harmvec, genremeans$HarmZ2[genremeans$genre=="jazz"]);
    fairvec <- c(fairvec, genremeans$FairZ2[genremeans$genre=="jazz"]);
    ingvec <- c(ingvec, genremeans$IngZ2[genremeans$genre=="jazz"]);
    authvec <- c(authvec, genremeans$AuthZ2[genremeans$genre=="jazz"]);
    purityvec <- c(purityvec, genremeans$PurityZ2[genremeans$genre=="jazz"]);
    negvec <- c(negvec, genremeans$negemo[genremeans$genre=="jazz"]);
    posvec <- c(posvec, genremeans$posemo[genremeans$genre=="jazz"]);
    religvec <- c(religvec, genremeans$relig[genremeans$genre=="jazz"]);
    progvec <- c(progvec, genremeans$ProgressivismTotal[genremeans$genre=="jazz"]);
    polvec <- c(polvec, joinedmeans$politicZ[joinedmeans$genre=="jazz"]);
    
    if (surveydata$listen_Jazz[surveydata$id==x] == 3) weightvec <- c(weightvec, 1);
    if (surveydata$listen_Jazz[surveydata$id==x] == 4) weightvec <- c(weightvec, 2);
    if (surveydata$listen_Jazz[surveydata$id==x] == 5) weightvec <- c(weightvec, 4);
    if (surveydata$listen_Jazz[surveydata$id==x] < 3 | surveydata$listen_Jazz[surveydata$id==x] > 5) weightvec <- c(weightvec, 0);
    if (surveydata$listen_Jazz[surveydata$id==x] < 3 | surveydata$listen_Jazz[surveydata$id==x] > 5) surveydata$Jazzfan[surveydata$id==x] <- 0
    else surveydata$Jazzfan[surveydata$id==x] <- 1;
  };
  
  if (surveydata$like_Reggae[surveydata$id==x] > 3 & surveydata$like_Reggae[surveydata$id==x] < 6) {
    harmvec <- c(harmvec, genremeans$HarmZ2[genremeans$genre=="reggae"]);
    fairvec <- c(fairvec, genremeans$FairZ2[genremeans$genre=="reggae"]);
    ingvec <- c(ingvec, genremeans$IngZ2[genremeans$genre=="reggae"]);
    authvec <- c(authvec, genremeans$AuthZ2[genremeans$genre=="reggae"]);
    purityvec <- c(purityvec, genremeans$PurityZ2[genremeans$genre=="reggae"]);
    negvec <- c(negvec, genremeans$negemo[genremeans$genre=="reggae"]);
    posvec <- c(posvec, genremeans$posemo[genremeans$genre=="reggae"]);
    religvec <- c(religvec, genremeans$relig[genremeans$genre=="reggae"]);
    progvec <- c(progvec, genremeans$ProgressivismTotal[genremeans$genre=="reggae"]);
    polvec <- c(polvec, joinedmeans$politicZ[joinedmeans$genre=="reggae"]);
    
    if (surveydata$listen_Reggae[surveydata$id==x] == 3) weightvec <- c(weightvec, 1);
    if (surveydata$listen_Reggae[surveydata$id==x] == 4) weightvec <- c(weightvec, 2);
    if (surveydata$listen_Reggae[surveydata$id==x] == 5) weightvec <- c(weightvec, 4);
    if (surveydata$listen_Reggae[surveydata$id==x] < 3 | surveydata$listen_Reggae[surveydata$id==x] > 5) weightvec <- c(weightvec, 0);
    if (surveydata$listen_Reggae[surveydata$id==x] < 3 | surveydata$listen_Reggae[surveydata$id==x] > 5) surveydata$Reggaefan[surveydata$id==x] <- 0
    else surveydata$Reggaefan[surveydata$id==x] <- 1;
  };
  
  if (surveydata$like_Blues[surveydata$id==x] > 3 & surveydata$like_Pop[surveydata$id==x] < 6) {
    harmvec <- c(harmvec, genremeans$HarmZ2[genremeans$genre=="blues"]);
    fairvec <- c(fairvec, genremeans$FairZ2[genremeans$genre=="blues"]);
    ingvec <- c(ingvec, genremeans$IngZ2[genremeans$genre=="blues"]);
    authvec <- c(authvec, genremeans$AuthZ2[genremeans$genre=="blues"]);
    purityvec <- c(purityvec, genremeans$PurityZ2[genremeans$genre=="blues"]);
    negvec <- c(negvec, genremeans$negemo[genremeans$genre=="blues"]);
    posvec <- c(posvec, genremeans$posemo[genremeans$genre=="blues"]);
    religvec <- c(religvec, genremeans$relig[genremeans$genre=="blues"]);
    progvec <- c(progvec, genremeans$ProgressivismTotal[genremeans$genre=="blues"]);
    polvec <- c(polvec, joinedmeans$politicZ[joinedmeans$genre=="blues"]);
    
    if (surveydata$listen_Blues[surveydata$id==x] == 3) weightvec <- c(weightvec, 1);
    if (surveydata$listen_Blues[surveydata$id==x] == 4) weightvec <- c(weightvec, 2);
    if (surveydata$listen_Blues[surveydata$id==x] == 5) weightvec <- c(weightvec, 4);
    if (surveydata$listen_Blues[surveydata$id==x] < 3 | surveydata$listen_Blues[surveydata$id==x] > 5) weightvec <- c(weightvec, 0);
    if (surveydata$listen_Blues[surveydata$id==x] < 3 | surveydata$listen_Blues[surveydata$id==x] > 5) surveydata$Bluesfan[surveydata$id==x] <- 0
    else surveydata$Bluesfan[surveydata$id==x] <- 1;
  };
  
  surveydata$lyricharmZ[surveydata$id==x] <- weighted.mean(harmvec, weightvec);
  surveydata$lyricfairZ[surveydata$id==x] <- weighted.mean(fairvec, weightvec);
  surveydata$lyricingZ[surveydata$id==x] <- weighted.mean(ingvec, weightvec);
  surveydata$lyricauthZ[surveydata$id==x] <- weighted.mean(authvec, weightvec);
  surveydata$lyricpurityZ[surveydata$id==x] <- weighted.mean(purityvec, weightvec);
  surveydata$lyricprogZ[surveydata$id==x] <- weighted.mean(progvec, weightvec);
  surveydata$lyricnegZ[surveydata$id==x] <- weighted.mean(negvec, weightvec);
  surveydata$lyricposZ[surveydata$id==x] <- weighted.mean(posvec, weightvec);
  surveydata$lyricreligZ[surveydata$id==x] <- weighted.mean(religvec, weightvec);
  surveydata$lyricpolZ[surveydata$id==x] <- weighted.mean(polvec, weightvec)
}

surveydata$genresfanned <- surveydata$Popfan+surveydata$Rockfan+surveydata$Christianfan+surveydata$Countryfan+surveydata$Rapfan+surveydata$Dancefan+surveydata$Rbfan+surveydata$Reggaefan+surveydata$Bluesfan+surveydata$Jazzfan;

surveydata4 <- subset(surveydata, genresfanned >= 3);
surveydata2 <- surveydata
surveydata2$ideo5[surveydata2$ideo5==6] <- NA;
surveydata2$pid3[surveydata2$pid3>2] <- NA;
surveydata2$respondent_race_2[surveydata2$respondent_race_2==2] <- 0;
surveydata2$respondent_race_2[surveydata2$respondent_race_2==2] <- 0;
surveydata2$faminc[surveydata2$faminc>16] <- NA;
surveydata2$christianrelig <- 0;
surveydata2$christianrelig[surveydata2$religpew<5] <- 1;
surveydata3 <- subset(surveydata2, is.na(ideo5)==FALSE)
```

## Basic question
The main thing we want to see here is whether the initial choice of looking at 2010-2015 was an influential one; were there over time changes in genres not captured here? Would the results have been different if we went further back in time? 

I have data for some genres going back to 1992. For these purposes, I have started with the year 2000 since that is about the time for which nearly every genre had its own Billboard chart. For each genre, I averaged the content analysis scores for each year (summed the rate for each song/total number of charted songs with lyrics). The resulting data is fairly simple, with a row for each genre, each year. One row might be blues in 2000, then blues in 2001, and so on. 

I then created a variable ranking each genre on each content analysis score for that year. So blues in 2000 might have had the most harm content of any genre, 7th most purity, and so on. What we're looking for is whether the rankings *have any clear trends* or *whose average ranking changes meaningfully depending on the time frame selected*. 

### Visualization
First, we can look at a few plots. These can quickly slip into information overload, so I will include fewer than the rather large amount that we would need to look at every content category.

``` {r}
ggplot(summary2, aes(summary2$year1,summary2$purity.rank, group=summary2$genre1, color=summary2$genre1)) + geom_line() + geom_point()
```

Above is the rank (10 = least, 1 = most) of purity content over time. You have to squint a bit, but you will see that there is a fair amount of stability for most genres. 

``` {r}
ggplot(summary2, aes(summary2$year1,summary2$authority.rank, group=summary2$genre1, color=summary2$genre1)) + geom_line() + geom_point()
```

Above is the same for authority, though there is some more volatility. 

### Average ranks
Another way to think about this question is whether the average rankings change depending on the time frame chosen. After all, our analyses aren't taking time into consideration, just a static number. Does the 5-year analysis differ from the 15?

What follows is first a list of the average yearly ranking for each genre on the purity foundation *over the course of 2010-2015*. The second list is the same average yearly ranking for purity, but *for 2000-2015*.
```{r}
puritysumfive <- summarise(summary3.grouped, purrank = mean(purity.rank))
arrange(puritysumfive, desc(purrank),genre1)
puritysumten <- summarise(summary2.grouped, purrank = mean(purity.rank))
arrange(puritysumten, desc(purrank),genre1)
```
Very little change in the average rankings when expanding the search backwards in time. Those genres that move up and down the list change very little in the actual average ranking.

And here is the same analysis for the authority foundation.
```{r}
authoritysumfive <- summarise(summary3.grouped, purrank = mean(authority.rank))
arrange(authoritysumfive, desc(purrank),genre1)
authoritysumten <- summarise(summary2.grouped, purrank = mean(authority.rank))
arrange(authoritysumten, desc(purrank),genre1)
```
Again, not many changes of note.

And a look at the loyalty foundation.
```{r}
ingroupsumfive <- summarise(summary3.grouped, purrank = mean(ingroup.rank))
arrange(ingroupsumfive, desc(purrank),genre1)
ingroupsumten <- summarise(summary2.grouped, purrank = mean(ingroup.rank))
arrange(ingroupsumten, desc(purrank),genre1)
```
More or less the same story; I'd consider the rearrangement from one timeframe to another as basically non-meaningful.

## Intraclass correlation

Another way to look at this problem is to treat each year's content analysis score like an observation and then see how reliable those observations are over time. This is starting with the assumption that time is not influential, but if correlations are low it could mean that there is a change over time; alternately, a low ICC could just indicate that the variation is very high and cast doubt on the usefulness of the measure. 

The following function does some of the heavy lifting for me, treating each genre as its own set of observations. Then each year is treated like a different observer in the sense that ICC is typically used for interrater reliability assessment. 

```{r warnings=FALSE}
statsBy(summary2, c("genre1"), method="pearson", na.rm=TRUE)
```

The first set of reported correlations is of most interest, ICC1. This is looking at within-group variance (the group is genre) as a portion of total variance. The "genre1" and "year1" columns aren't interpretable as one is the grouping variable and the other are just years and are being (mistakenly) treated as meaningful integers by the analysis. We do see fairly strong ICC here, with the exception of the fairness rankings...this makes sense since fairness is by far the least frequently occurring content category. This is computationally near-equivalent to one-way ANOVA.

## Albums vs. singles
Another thing to look at was whether singles and albums differ in a way that should concern us. There are 5 genres for which we have both singles charts and album charts; those are the genres for which quesitons could be raised. I'm going to show the results of a few t-tests that compare all 5 of the genres' singles with all their albums. I've run the same tests comparing only within genre, but the results would be too lengthy to output here. I didn't see any genre-specific patterns of note.

First, this is just the total moral content. This would be the first red flag if there is a big difference.

```{r}
t.test(test3$totmoral[test3$BBgenre %in% c("christian-songs","rock-songs","country-songs","dance-electronic-songs","rap-song","r-b-hip-hop-songs")],test3$totmoral[test3$BBgenre %in% c("christian-albums","rock-albums","country-albums","dance-electronic-albums","rap-albums","r-b-hip-hop-albums")])
```

This is a miniscule effect size (*d* = 0.06), despite the *p* significance. I am not concerned about this result.

Next I look at the purity foundation in particular, though again I will mention I've looked at each and they all tell the same story.
```{r}
t.test(test3$purity[test3$BBgenre %in% c("christian-songs","rock-songs","country-songs","dance-electronic-songs","rap-song","r-b-hip-hop-songs")],test3$purity[test3$BBgenre %in% c("christian-albums","rock-albums","country-albums","dance-electronic-albums","rap-albums","r-b-hip-hop-albums")])
```

Even smaller effect size here. No worries at all.

Now I'm checking for differences in the newly-added politics content category. 
```{r}
t.test(test3$politic[test3$BBgenre %in% c("christian-songs","rock-songs","country-songs","dance-electronic-songs","rap-song","r-b-hip-hop-songs")],test3$politic[test3$BBgenre %in% c("christian-albums","rock-albums","country-albums","dance-electronic-albums","rap-albums","r-b-hip-hop-albums")])
```

Here we see meaningful differences, even in consideration of the large number of observations. The pro-single "bias" makes logical sense, to be sure, though the takeaway is unclear in terms of analysis. This category isn't central to our claims in any case and probably won't make it into the final published document. Even if so, I think including both albums+singles is the most defensible decision given there are genres for which we have only singles (pop) or only albums (blues,jazz,reggae).

## Changes to survey results if politics is considered?
Now the main reason for working in this politics dictionary category was to make sure that this wasn't some important, unmeasured variable in the original analyses. At this point I have loaded all the data from the November analyses in the background and will re-run some of them with the politics variable included as is appropriate.

Rather than doing each step, I'm skipping to the final step from the MAPOR paper...but with the politics variable added. 

```{r}
fit5 <- lm(MFQ_PROGRESSIVISM_AVG ~ educ + respondent_race_2 + gender + age + christianrelig + ideo5 + lyricpolZ + lyricharmZ + lyricingZ + lyricauthZ + lyricpurityZ, data=surveydata3)
summary(fit5)
```

No major change to the results here. As we would expect, political content in lyrics—without judging the partisan nature of said political content—has no clear relationship with moral progressivism. 

Note that I have also removed the fairness foundation variable due to earlier observations about its over-time variance and general non-presence in the data. This has the side effect of reducing multicollinearity:

```{r}
vif(fit5)
```

With both the fairness lyric variable, which I have had reservations about since before I ran my first regression model on this data, and the politics lyric variable, the multicollinearity is such that the model can't be interpreted (two lyrics predictors with VIF > 10). Without the politics variable but keeping the fairness variable (the MAPOR version), multicollinearity is still a concern (3 predictors have VIF > 5, 1 > 8). The model above, for which you can see the VIF values, looks much better. I do have to wonder about the most befuddling result—that increases in authority lyrics are associated with increases in progressivism—might be partly influenced by it showing the highest collinearity. The other model diagnostics look good and are basically unchanged from the MAPOR analysis.

For reference, below is the regression output if the model does *not* include the politics variable.

```{r}
fit6 <- lm(MFQ_PROGRESSIVISM_AVG ~ educ + respondent_race_2 + gender + age + christianrelig + ideo5 + lyricharmZ + lyricingZ + lyricauthZ + lyricpurityZ, data=surveydata3)
summary(fit6)
```
